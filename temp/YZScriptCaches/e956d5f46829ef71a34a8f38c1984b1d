define("zenjs/util/number",[],function(){return{makeRandomString:function(t){var i="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t=t||10;for(var e=0;e<t;e++)i+=o.charAt(Math.floor(Math.random()*o.length));return i}}}),define("bower_components/pop/pop",["require","zenjs/events","zenjs/util/number"],function(t){var i=function(){},o=t("zenjs/events"),e=t("zenjs/util/number");return window.zenjs=window.zenjs||{},o.extend({init:function(t){this._window=$(window);var o=e.makeRandomString();$("body").append('<div id="'+o+'"                 style="display:none; height: 100%;                 position: fixed; top: 0; left: 0; right: 0;                background-color: rgba(0, 0, 0, '+(t.transparent||".7")+');z-index:1000;opacity:0;transition: opacity ease 0.2s;"></div>'),this.nBg=$("#"+o),this.nBg.on("click",$.proxy(function(){this.isCanNotHide||this.hide()},this));var s=e.makeRandomString();$("body").append('<div id="'+s+'" class="'+(t.className||"")+'" style="overflow:hidden;visibility: hidden;"></div>'),this.nPopContainer=$("#"+s),this.nPopContainer.hide(),this.nPopContainer.css({opacity:0,position:"absolute","z-index":1e3}),t.contentViewClass&&(this.contentViewClass=t.contentViewClass,this.contentViewOptions=$.extend({el:this.nPopContainer},t.contentViewOptions||{}),this.contentView=new this.contentViewClass($.extend({onHide:$.proxy(this.hide,this)},this.contentViewOptions)),this.contentView.onHide=$.proxy(this.hide,this)),this.animationTime=t.animationTime||300,this.isCanNotHide=t.isCanNotHide,this.doNotRemoveOnHide=t.doNotRemoveOnHide||!1,this.onShow=t.onShow||i,this.onHide=t.onHide||i,this.onFinishHide=t.onFinishHide||i,this.html=t.html},render:function(t){return this.renderOptions=t||{},this.contentViewClass?this.contentView.render(this.renderOptions):this.html&&this.nPopContainer.html(this.html),this},show:function(){return this.nBg.show().css({opacity:"1","transition-property":"none"}),this.nPopContainer.show(),this.trigger("pop:show:before"),setTimeout($.proxy(function(){this.trigger("pop:show:after"),this.nPopContainer.show().css("visibility","visible"),this._doShow&&this._doShow(),this.onShow()},this),200),this},hide:function(t){t=t||{};var i=t.doNotRemove||this.doNotRemoveOnHide||!1;this._doHide&&this._doHide(),this.trigger("pop:hide:before"),setTimeout($.proxy(function(){this.nBg.css({opacity:0,"transition-property":"opacity"}),this.trigger("pop:hide:after"),setTimeout($.proxy(function(){this.nBg.hide(),this.nPopContainer.hide(),i||this.destroy()},this),200)},this),this.animationTime),this.onHide()},destroy:function(){return this.nPopContainer.remove(),this.nBg.remove(),this.contentView&&this.contentView.remove(),this}})}),define("bower_components/pop/pop_forbid_scroll",["require","./pop"],function(t){return window.zenjs=window.zenjs||{},t("./pop").extend({init:function(t){this._super(t),t.doNotForbidScroll||(this.on("pop:show:before",$.proxy(this.onBeforePopShow,this)),this.on("pop:show:after",$.proxy(this.onAfterPopShow,this)),this.on("pop:hide:after",$.proxy(this.onAfterPopHide,this)))},onBeforePopShow:function(){this.top=this._window.scrollTop()},onAfterPopShow:function(){this._window.scrollTop(0),this.startShow()},onAfterPopHide:function(){var t,i=function(o){if(t!==this._window.scrollTop()&&o>0)return this._window.scrollTop(t),void setTimeout($.proxy(i,this,o-1));setTimeout($.proxy(this.onFinishHide,this),50)};return function(){this.startHide(),t=this.top,this._window.scrollTop(t),$.proxy(i,this)(2),setTimeout($.proxy(function(){window.zenjs.popList.length<1&&$("html").css("position",this.htmlPosition)},this),200)}}(),startShow:function(){var t=window.zenjs.popList;if(t||(t=window.zenjs.popList=[]),0===t.length){var i=$("body"),o=$("html");this.htmlPosition=o.css("position"),o.css("position","relative"),this.bodyCss=(i.prop("style")||{}).cssText,this.htmlCss=(o.prop("style")||{}).cssText,$("body,html").css({overflow:"hidden",height:this._window.height(),"padding-bottom":0,"margin-bottom":0})}t.indexOf(this)<0&&t.push(this)},startHide:function(){var t=window.zenjs.popList,i=t.indexOf(this);i>-1&&t.splice(i,1),t.length<1&&($("html").attr("style",this.htmlCss||""),$("body").attr("style",this.bodyCss||""))}})}),define("bower_components/pop/popout",["require","./pop_forbid_scroll"],function(t){return t("./pop_forbid_scroll").extend({init:function(t){t=t||{},this._super(t),this.css=$.extend({transition:"opacity ease "+this.animationTime+"ms",top:"50%",left:"50%","-webkit-transform":"translate3d(-50%, -50%, 0)",transform:"translateY(-50%, -50%, 0)"},t.css||{}),this.nPopContainer.css(this.css)},_doShow:function(){$(".js-popout-close").click($.proxy(function(t){this.hide()},this)),this.nPopContainer.css("opacity",1),this.nPopContainer.show()},_doHide:function(t){this.nPopContainer.css({opacity:0})}})}),define("bower_components/pop/popout_box",["require","./popout"],function(t){var i=function(){};return t("./popout").extend({init:function(t){this._super(t),this._onOKClicked=t.onOKClicked||i,this._onCancelClicked=t.onCancelClicked||i,this.preventHideOnOkClicked=t.preventHideOnOkClicked||!1,this.width=t.width,this.setEventListener()},setEventListener:function(){this.nPopContainer.on("click",".js-ok",$.proxy(this.onOKClicked,this)),this.nPopContainer.on("click",".js-cancel",$.proxy(this.onCancelClicked,this))},_doShow:function(){this.boxCss={"border-radius":"4px",background:"white",width:this.width||"270px",padding:"15px"},this.nPopContainer.css(this.boxCss).addClass("popout-box"),this._super()},_doHide:function(t){this._super()},onOKClicked:function(t){this._onOKClicked(t),!this.preventHideOnOkClicked&&this.hide()},onCancelClicked:function(t){this._onCancelClicked(t),this.hide()}})}),define("wap/fenxiao/components/log",[],function(){var t=function(){};return{displayLog:function(i,o){o=o||t;var e={fm:"display",display_goods:i.display_goods,spm:"wxdatv-"+i.activity_id,target:"wxd",seller_kdt_id:i.seller_kdt_id,title:i.title||document.title,result_from:i.result_from||"",result_number:i.result_number||""};window.Logger&&window.Logger.log(e).done(o)},beforeAddLog:function(i,o){o=o||t;var e={fm:"click",click_type:"wxd_before_add",seller_kdt_id:i.seller_kdt_id,display_goods:i.display_goods,spm:"wxdatv-"+i.activity_id,target:"wxd",title:i.title||document.title,result_from:i.result_from||"",result_number:i.result_number||""};window.Logger&&window.Logger.log(e).done(o)},gotoDetailLog:function(i,o){o=o||t;var e={fm:"display",display_goods:i.display_goods,spm:"wxdatv-"+i.activity_id+"_wxdg"+i.kdt_goods_id,target:"wxd",seller_kdt_id:i.seller_kdt_id,title:i.title||document.title,result_from:i.result_from||"",result_number:i.result_number||""};window.Logger&&window.Logger.log(e).done(o)},addGoodsSuccessLog:function(i,o){o=o||t;var e={fm:"click",click_type:"wxd_add",seller_kdt_id:i.seller_kdt_id,display_goods:i.display_goods,spm:"wxdatv-"+i.activity_id,target:"wxd",title:i.title||document.title,result_from:i.result_from||"",result_number:i.result_number||""};window.Logger&&window.Logger.log(e).done(o)}}}),define("wap/fenxiao/components/wxd_list_common_operate",["require","exports","module","zenjs/class","bower_components/youzanjsbridge/api","wap/fenxiao/components/log","zenjs/util/args","zenjs/util/ua"],function(t,i,o){var e=t("zenjs/class"),s=t("bower_components/youzanjsbridge/api"),n=t("wap/fenxiao/components/log"),d=t("zenjs/util/args"),a=t("zenjs/util/ua"),r=_global.access_token||d.get("access_token");o.exports=e.extend({init:function(t){t=t||{},this.wrap=t.wrap||"body",this.operateClassName=t.operateClassName||".js-operate-btn",this.gotoDetailClassName=t.gotoDetailClassName||".js-goto-detail",this.needAddGoodsOtherInfo=t.needAddGoodsOtherInfo||!1,this.needGotoDetailOtherInfo=t.needGotoDetailOtherInfo||!1,this.canAddGoods=!0,this.banAddGoodsTip=t.banAddGoodsTip||!1,this.initAddGoods(),this.initGotoDetail()},initAddGoods:function(){var t=this;this.initAddGoodsListen(),$(this.wrap).on("click",this.operateClassName,function(i){i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation();var o=$(this).parents(t.gotoDetailClassName).data()||{};o.seller_goods_alias?t.addGoodsItem(o):t.canAddGoods?n.beforeAddLog({seller_kdt_id:_global.kdt_id||0,display_goods:o.kdt_goods_id,activity_id:o.activity_id||0,title:o.title||document.title},function(){t.addGoodsItem(o)}):t.banAddGoodsTip&&motify.log(t.banAddGoodsTip)})},initGotoDetail:function(){$(this.wrap).on("click",this.gotoDetailClassName,function(t){t.preventDefault(),t.stopPropagation();var i=$(this).data(),o=_global.url.wap+"/showcase_fenxiao/goods/active",e={};o=d.add(o,{alias:i.alias}),r&&(o=d.add(o,{access_token:r})),this.needGotoDetailOtherInfo&&$.each(this.needGotoDetailOtherInfo,function(t,o){e[o]=i.value}),n.gotoDetailLog({display_goods:i.kdt_goods_id,activity_id:i.activity_id||0,kdt_goods_id:i.kdt_goods_id,seller_kdt_id:_global.kdt_id||0,title:i.title||document.title},function(){a.isWxd()?s.gotoWebview($.extend({page:"web",url:o},e)):window.location.href=o})})},setCanAddGoods:function(t){this.canAddGoods=t},addGoodsItem:function(t){s.gotoNative({page:"addGoods",alias:t.alias,seller_goods_alias:t.seller_goods_alias})},initAddGoodsListen:function(){var t=this;s.on("addGoodsSuccess",function(i){var o=i.alias,e=$(t.gotoDetailClassName+'[data-alias="'+o+'"]'),s=e.data();e.data("seller_goods_alias",i.seller_goods_alias),e.find(t.operateClassName).addClass("added").removeClass("add"),n.addGoodsSuccessLog({seller_kdt_id:_global.kdt_id,display_goods:s.kdt_goods_id,activity_id:s.activity_id||0,title:s.title||document.title})})}})}),define("text!wap/fenxiao/enterprise/main_goods/template/add_goods_bar.html",[],function(){return'<div class="tip-warp js-tip-warp clearfix">\n  <p class="tip">主打商品是企业在当季的热销商品。</p>\n  <button class="add-btn js-add-goods-list">一键添加</button>\n</div>'}),define("text!wap/fenxiao/enterprise/main_goods/template/add_all_tip.html",[],function(){return'<style>\n    .modal p {\n        padding: 10px 0 15px 0;\n    }\n    .modal .btn-actions .btn {\n        width: 100%;\n        margin: 0;\n        padding: 10px 0 0 0;\n        float: left;\n        border: 0;\n        font-size: 14px;\n    }\n    .modal .btn-actions .btn:last-child {\n        color: #ed5050;\n        font-weight: bold;\n    }\n</style>\n\n<div class="modal">\n\t<p class="center">商品全部上架成功</p>\n\t<hr>\n\t<div class="btn-actions clear-fix">\n\t\t<a class="btn js-cancel">确定</a>\n\t</div>\n</div>\n'}),define("text!wap/fenxiao/common/templates/wxd_goods_list_1.html",[],function(){return'<% _.each(list,function(item){ %>\n    <div class="block-item name-card js-goto-detail"\n        data-alias="<%= item.alias %>"\n        data-kdt_goods_id="<%= item.kdt_goods_id %>"\n        data-seller_goods_alias="<%= item.seller_goods_alias %>"\n        data-kdt_id="<%= item.kdt_id %>"\n        data-activity_id="<%= item.activity_id %>"\n        data-title="<%= item.title %>"\n    >\n        <div class="thumb">\n            <img class="img" src="<% if(item.thumb_image){%><%= item.thumb_image %><% }else if(item.image_url){ %><%= item.image_url %> <% } %>" />\n        </div>\n        <div class="detail clearfix">\n            <h3 class="title ellipsis"><%= item.title %></h3>\n            <p class="item">库存<%= item.stock_num %>件，<%= item.fx_count %>人分销</p>\n            <p class="item">建议售价：¥<%= item.suggest_retail_price %></p>\n            <p class="item profit">平均利润：<span class="c-red">¥<%= item.average_profit %></span> /件</p>\n        </div>\n        <% if ((item.seller_goods_alias && item.seller_goods_alias !== \'\') || item.is_added !== false) { %>\n            <span class="opt added js-operate-btn"></span>\n        <% } else { %>\n            <span class="opt add js-operate-btn"></span>\n        <% } %>\n    </div>\n<% }) %>\n'}),require(["underscore","zenjs/events","zenjs/util/args","bower_components/pop/popout_box","wap/fenxiao/components/wxd_list_common_operate","text!wap/fenxiao/enterprise/main_goods/template/add_goods_bar.html","text!wap/fenxiao/enterprise/main_goods/template/add_all_tip.html","text!wap/fenxiao/common/templates/wxd_goods_list_1.html"],function(t,i,o,e,s,n,d,a){var r=_global.access_token||o.get("access_token");new(i.extend({init:function(){this.initAddGoodsList(),this.getMainGoodsList(!0),this.template=t.template(a),this.isReadyAddAll=!0,this.on("fetchSuccess",this.renderGoodsList),this.operate=new s({banAddGoodsTip:"商品正在上架请稍后重试..."})},getMainGoodsList:function(t){var i=this;$._ajax({url:"/v2/fenxiao/enterprise/MainGoods.json",data:{access_token:r},success:function(o){0===o.code?t?i.trigger("fetchSuccess",o.data,!0):i.trigger("fetchSuccess",o.data):motify.log(o.msg)},error:function(t){motify.log(t)}})},renderGoodsList:function(i,o){if(0===i.length)return void $(".js-goods-list").html('<div class="empty-notice">暂无主打商品</div>');var e=t.find(i,function(t){return t.is_added===!1});o&&e&&(this.isReadyAddAll=!1,$(".js-goods-list").before(t.template(n)())),this.isReadyAddAll||e||($(".js-tip-warp").remove(),this.showAddAllTip(),this.isReadyAddAll=!0,this.operate.setCanAddGoods(!0)),$(".js-goods-list").html(this.template({list:i}))},showAddAllTip:function(){var i=new e({isCanNotHide:!0,html:t.template(d)(),onCancelClicked:function(){i.hide()}});i.render().show()},initAddGoodsList:function(){var t=this;$("body").on("click",".js-add-goods-list",function(){t.postAddGoodsList(),t.operate&&t.operate.setCanAddGoods(!1),$(this).html("刷新").addClass("js-refresh refresh").removeClass("js-add-goods-list")}),$("body").on("click",".js-refresh",function(){motify.log("上架中，请稍候...",800),t.getMainGoodsList()})},postAddGoodsList:function(){var t=this;$._ajax({url:"/v2/fenxiao/enterprise/PutMainGoodsOnSale.json",data:{access_token:r},type:"POST",success:function(i){0===i.code?t.getMainGoodsList():motify.log(i.msg)},error:function(t){motify.log(t)}})}}))}),define("main",function(){});