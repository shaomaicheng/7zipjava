define("zenjs/util/number",[],function(){return{makeRandomString:function(t){var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t=t||10;for(var i=0;i<t;i++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}}}),define("bower_components/pop/pop",["require","zenjs/events","zenjs/util/number"],function(t){var e=function(){},n=t("zenjs/events"),i=t("zenjs/util/number");return window.zenjs=window.zenjs||{},n.extend({init:function(t){this._window=$(window);var n=i.makeRandomString();$("body").append('<div id="'+n+'"                 style="display:none; height: 100%;                 position: fixed; top: 0; left: 0; right: 0;                background-color: rgba(0, 0, 0, '+(t.transparent||".7")+');z-index:1000;opacity:0;transition: opacity ease 0.2s;"></div>'),this.nBg=$("#"+n),this.nBg.on("click",$.proxy(function(){this.isCanNotHide||this.hide()},this));var o=i.makeRandomString();$("body").append('<div id="'+o+'" class="'+(t.className||"")+'" style="overflow:hidden;visibility: hidden;"></div>'),this.nPopContainer=$("#"+o),this.nPopContainer.hide(),this.nPopContainer.css({opacity:0,position:"absolute","z-index":1e3}),t.contentViewClass&&(this.contentViewClass=t.contentViewClass,this.contentViewOptions=$.extend({el:this.nPopContainer},t.contentViewOptions||{}),this.contentView=new this.contentViewClass($.extend({onHide:$.proxy(this.hide,this)},this.contentViewOptions)),this.contentView.onHide=$.proxy(this.hide,this)),this.animationTime=t.animationTime||300,this.isCanNotHide=t.isCanNotHide,this.doNotRemoveOnHide=t.doNotRemoveOnHide||!1,this.onShow=t.onShow||e,this.onHide=t.onHide||e,this.onFinishHide=t.onFinishHide||e,this.html=t.html},render:function(t){return this.renderOptions=t||{},this.contentViewClass?this.contentView.render(this.renderOptions):this.html&&this.nPopContainer.html(this.html),this},show:function(){return this.nBg.show().css({opacity:"1","transition-property":"none"}),this.nPopContainer.show(),this.trigger("pop:show:before"),setTimeout($.proxy(function(){this.trigger("pop:show:after"),this.nPopContainer.show().css("visibility","visible"),this._doShow&&this._doShow(),this.onShow()},this),200),this},hide:function(t){t=t||{};var e=t.doNotRemove||this.doNotRemoveOnHide||!1;this._doHide&&this._doHide(),this.trigger("pop:hide:before"),setTimeout($.proxy(function(){this.nBg.css({opacity:0,"transition-property":"opacity"}),this.trigger("pop:hide:after"),setTimeout($.proxy(function(){this.nBg.hide(),this.nPopContainer.hide(),e||this.destroy()},this),200)},this),this.animationTime),this.onHide()},destroy:function(){return this.nPopContainer.remove(),this.nBg.remove(),this.contentView&&this.contentView.remove(),this}})}),define("bower_components/pop/pop_forbid_scroll",["require","./pop"],function(t){return window.zenjs=window.zenjs||{},t("./pop").extend({init:function(t){this._super(t),t.doNotForbidScroll||(this.on("pop:show:before",$.proxy(this.onBeforePopShow,this)),this.on("pop:show:after",$.proxy(this.onAfterPopShow,this)),this.on("pop:hide:after",$.proxy(this.onAfterPopHide,this)))},onBeforePopShow:function(){this.top=this._window.scrollTop()},onAfterPopShow:function(){this._window.scrollTop(0),this.startShow()},onAfterPopHide:function(){var t,e=function(n){if(t!==this._window.scrollTop()&&n>0)return this._window.scrollTop(t),void setTimeout($.proxy(e,this,n-1));setTimeout($.proxy(this.onFinishHide,this),50)};return function(){this.startHide(),t=this.top,this._window.scrollTop(t),$.proxy(e,this)(2),setTimeout($.proxy(function(){window.zenjs.popList.length<1&&$("html").css("position",this.htmlPosition)},this),200)}}(),startShow:function(){var t=window.zenjs.popList;if(t||(t=window.zenjs.popList=[]),0===t.length){var e=$("body"),n=$("html");this.htmlPosition=n.css("position"),n.css("position","relative"),this.bodyCss=(e.prop("style")||{}).cssText,this.htmlCss=(n.prop("style")||{}).cssText,$("body,html").css({overflow:"hidden",height:this._window.height(),"padding-bottom":0,"margin-bottom":0})}t.indexOf(this)<0&&t.push(this)},startHide:function(){var t=window.zenjs.popList,e=t.indexOf(this);e>-1&&t.splice(e,1),t.length<1&&($("html").attr("style",this.htmlCss||""),$("body").attr("style",this.bodyCss||""))}})}),define("bower_components/pop/popout",["require","./pop_forbid_scroll"],function(t){return t("./pop_forbid_scroll").extend({init:function(t){t=t||{},this._super(t),this.css=$.extend({transition:"opacity ease "+this.animationTime+"ms",top:"50%",left:"50%","-webkit-transform":"translate3d(-50%, -50%, 0)",transform:"translateY(-50%, -50%, 0)"},t.css||{}),this.nPopContainer.css(this.css)},_doShow:function(){$(".js-popout-close").click($.proxy(function(t){this.hide()},this)),this.nPopContainer.css("opacity",1),this.nPopContainer.show()},_doHide:function(t){this.nPopContainer.css({opacity:0})}})}),define("bower_components/pop/popout_box",["require","./popout"],function(t){var e=function(){};return t("./popout").extend({init:function(t){this._super(t),this._onOKClicked=t.onOKClicked||e,this._onCancelClicked=t.onCancelClicked||e,this.preventHideOnOkClicked=t.preventHideOnOkClicked||!1,this.width=t.width,this.setEventListener()},setEventListener:function(){this.nPopContainer.on("click",".js-ok",$.proxy(this.onOKClicked,this)),this.nPopContainer.on("click",".js-cancel",$.proxy(this.onCancelClicked,this))},_doShow:function(){this.boxCss={"border-radius":"4px",background:"white",width:this.width||"270px",padding:"15px"},this.nPopContainer.css(this.boxCss).addClass("popout-box"),this._super()},_doHide:function(t){this._super()},onOKClicked:function(t){this._onOKClicked(t),!this.preventHideOnOkClicked&&this.hide()},onCancelClicked:function(t){this._onCancelClicked(t),this.hide()}})}),define("text!bower_components/pop/pop_alert/box.html",[],function(){return'<div class="alert-content font-size-14" style="line-height: 1.4; padding: 5px 0;">\n    <%= data.box_content %>\n</div>\n<hr style="margin: 10px 0 11px;">\n<p class="js-ok confirm center c-green" style="line-height: 22px;">\n    <%= data.box_confirm %>\n</p>'}),define("zenjs/util/template",["require","jquery"],function(t){var e=t("jquery"),n=function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},e=["&","<",">",'"',"'"],n=new RegExp("["+e.join("")+"]","g");return function(e){return null==e?"":(""+e).replace(n,function(e){return t[e]})}}(),i={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},o={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};return function(t,s,r){var a;r=e.extend({},i,r);var c=new RegExp([(r.escape||/(.)^/).source,(r.interpolate||/(.)^/).source,(r.evaluate||/(.)^/).source].join("|")+"|$","g"),l=0,h="__p+='";t.replace(c,function(e,n,i,s,r){return h+=t.slice(l,r).replace(/\\|'|\r|\n|\t|\u2028|\u2029/g,function(t){return"\\"+o[t]}),n&&(h+="'+\n((__t=("+n+"))==null?'':escapeFunc(__t))+\n'"),i&&(h+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),s&&(h+="';\n"+s+"\n__p+='"),l=r+e.length,e}),h+="';\n",r.variable||(h="with(obj||{}){\n"+h+"}\n"),h="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+h+"return __p;\n";try{a=new Function(r.variable||"obj","escapeFunc",h)}catch(t){throw t.source=h,t}if(s)return a(s,n);var d=function(t){return a.call(this,t,n)};return d.source="function("+(r.variable||"obj")+"){\n"+h+"}",d}}),define("bower_components/pop/pop_alert/popout_alert",["require","../popout_box","text!../pop_alert/box.html","zenjs/util/template"],function(t){var e=t("../popout_box"),n=t("text!../pop_alert/box.html"),i=t("zenjs/util/template"),o=i(n),s=e.extend({init:function(t){this._super(t),this.isCanNotHide=!0,this.box_content=t.content||"",this.box_confirm=t.confirmText||"我知道了"},render:function(t){return this.html||(this.html=o({data:{box_content:this.box_content,box_confirm:this.box_confirm}})),this._super(t),this.nPopContainer.addClass("popout-alert"),this},_doShow:function(){this._super()},_doHide:function(t){this._super()}}),r=null;return{show:function(t,e){e=e||{},r&&this.hide(),e.content=t,r=new s(e).render().show()},hide:function(){r&&(r.hide(),r=null)}}}),window.Zepto&&function(t){t.fn.serializeArray=function(){var e,n,i=[],o=function(t){if(t.forEach)return t.forEach(o);i.push({name:e,value:t})};return this[0]&&t.each(this[0].elements,function(i,s){n=s.type,e=s.name,e&&"fieldset"!=s.nodeName.toLowerCase()&&!s.disabled&&"submit"!=n&&"reset"!=n&&"button"!=n&&"file"!=n&&("radio"!=n&&"checkbox"!=n||s.checked)&&o(t(s).val())}),i},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(0 in arguments)this.bind("submit",e);else if(this.length){var n=t.Event("submit");this.eq(0).trigger(n),n.isDefaultPrevented()||this.get(0).submit()}return this}}(Zepto),define("vendor/zepto/form",function(){}),window.Utils=window.Utils||{},define("wap/components/util/form",["vendor/zepto/form"],function(t){window.Utils.getFormData=function(t){var e=t.serializeArray(),n={};return $.map(e,function(t){n[t.name]=t.value}),n}}),define("zenjs/sms_fetch/main",["require","exports","module","bower_components/ajax/ajax","zenjs/util/args","jquery"],function(t,e,n){function i(){this.loadingLock=!1,this.isUsed=void 0}function o(t){t=t||{},this.$el=r(t.el||t.$el||"<div></div>"),this.el=this.$el[0],this.$=function(t){return this.$el.find(t)},this.initialize&&this.initialize(t)}t("bower_components/ajax/ajax");var s=t("zenjs/util/args"),r=t("jquery"),a=function(){};i.prototype={fetch:function(){if(this.isUsed!==!1){var t=this;this.loadingLock=!0,r._ajax({url:window._global.url.www.replace(/^https?:\/\//,"//")+"/common/token/token.jsonp",type:"get",dataType:"jsonp"}).done(function(e){0==e.code?(t.token=e.data,t.loadingLock=!1,t.isUsed=!1):motify.log(e.msg)}).fail(function(){motify.log("token 获取失败")})}},get:function(){return this.isUsed=!0,this.token}};var c=new i;r.extend(o.prototype,{initialize:function(t){this.duration=t.time||60,this.step=t.step||1100,this.codeVerifyClass=t.codeVerifyClass||"js-verify-code",this.verifyType="smsFetch";var e=window._global.url.www.replace(/^https?:\/\//,"//");this.smsFetchUrl=e+"/common/sms/captcha.jsonp",this.imgUrl=e+"/common/sms/imgcaptcha",this.imgVerifyUrl=e+"/common/sms/imgcaptcha.jsonp",this.biz=t.biz||"kdt_account_captcha",this.onTimeChange=t.onTimeChange||a,this.onTimeEnd=t.onTimeEnd||a,this.onTimerStart=t.onTimerStart||a,this.onTimerClose=t.onTimerClose||a,this.onVerifyPictureShow=t.onVerifyPictureShow||a,this.onGetCodeError=t.onGetCodeError||a,this.onVerifyPictureSuccess=t.onVerifyPictureSuccess||a,this.onVerifyPictureError=t.onVerifyPictureError||a,this.platform=t.platform||"",this.subFrom=t.subFrom||"",c.fetch()},setMobile:function(t){t&&(this.mobile=t)},getImageCode:function(){return r.trim(this.$("."+this.codeVerifyClass).val())},getSms:function(t){var e=this;if(c.loadingLock)return void motify.log("数据加载中，稍后再试");if(t=t||{},t.mobile&&(this.mobile=t.mobile),!this.mobile)return!1;var n={smsFetch:e.onSmsFetchHandler,image:e.onImageHandler};return e.startTimer.call(e),(n[e.verifyType]||a).call(e),this},startTimer:function(){this.onTimerStart(),this.btnCountdown(this.duration)},stopTimer:function(){clearTimeout(this.timer),this.onTimerClose()},btnCountdown:function(t){var e=this;this.onTimeChange({second:t}),--t>=0?this.timer=setTimeout(function(){e.btnCountdown(t)},this.step):(this.onTimeEnd(),this.timer="")},onVerifyImageShow:function(t){this.$(".js-image-verify").removeClass("hide"),this.$(".js-verify-image").attr("src",t)},onVerifyImageHide:function(){this.$(".js-image-verify").addClass("hide")},onSmsFetchHandler:function(){var t=1;return function(){var e=this,n={verifyTimes:t,mobile:this.mobile,biz:this.biz,token:c.get()};this.platform&&(n.platform=this.platform),this.subFrom&&(n.sub_from=this.subFrom),r._ajax({url:this.smsFetchUrl,dataType:"jsonp",data:n,success:function(n){if(0==n.code)return void t++;e.stopTimer.call(e),e.onGetCodeError.call(e),10111===n.code?(e.verifyType="image",e.onVerifyImageShow(e.imgUrl),e.onVerifyPictureShow()):(t++,motify.log(n.msg))},error:function(n,i,o){t++,e.stopTimer.call(e),e.onGetCodeError.call(e),motify.log("获取验证码失败，请稍后再试")},complete:function(t,e){}}).always(function(){c.fetch()})}}(),onImageHandler:function(){var t=this,e=this.mobile;r._ajax({url:this.imgVerifyUrl,dataType:"jsonp",data:{mobile:e,captcha_code:this.getImageCode()},success:function(n){if(0===n.code)return t.verifyType="smsFetch",t.mobile=e,t.onVerifyImageHide(),t.onVerifyPictureSuccess(),void t.onSmsFetchHandler();t.stopTimer.call(t),t.onVerifyPictureError.call(t),10100===n.code?(motify.log(n.msg),t.reloadCaptcha()):motify.log(n.msg)},error:function(e,n,i){t.stopTimer.call(t),t.onVerifyPictureError.call(t),motify.log("图形验证失败，重试一下吧~"),t.reloadCaptcha()},complete:function(t,e){}})},reloadCaptcha:function(){var t=s.add(this.imgUrl,{stamp:new Date});this.$el.find(".js-verify-image").attr("src",t)}}),n.exports=o}),require(["wap/components/util/form","zenjs/sms_fetch/main","zenjs/util/args","bower_components/youzanjsbridge/api","zenjs/util/ua"],function(t,e,n,i,o){function s(t){return $.each(t,function(e,n){t[e]=$.trim(n)}),t}function r(t){return t.phone?/^1\d{10}$/.test(t.phone)?!!t.code||(l.log("请先填写你的短信验证码"),u.focus(),!1):(l.log("请填写11位手机号码"),d.focus(),!1):(l.log("请先填写你的手机号码"),d.focus(),!1)}function a(t){var e=window._global.url.uic.replace(/^https?:\/\//,"//")+"/buyer/user/updatemaininfo.json";$.ajax({url:e,type:"POST",dataType:"json",data:t,timeout:15e3,xhrFields:{withCredentials:!0},beforeSend:function(){},success:function(e){if(0===e.code){var n=window._global.redirect_url;"wxd"===m||"wsc"===m||"youzanmars"===w?($(".js-change-phone-form").addClass("hide"),$(".js-success-tip").removeClass("hide"),$(".js-goto-login").removeClass("hide")):n?(l.log("修改手机号成功",0),setTimeout(function(){n+=-1===n.indexOf("?")?"?":"&",n+="phone="+t.phone,window.location.href=n},1e3)):($(".js-change-phone-form").addClass("hide"),$(".js-success-tip").removeClass("hide"))}else l.log(e.msg)},error:function(){v.stopTimer(),l.log("获取验证码失败，请稍后再试")},complete:function(){}})}var c=window.Utils,l=window.motify,h=$(".js-send-auth"),d=$(".js-txt-telphone"),u=$(".js-txt-auth"),p=$(".js-login-cancel"),f=$(".js-help-info"),m=n.get("kdtfrom"),w=_global.platform;"wxd"!==m&&"wsc"!==m&&"youzanmars"!==w&&$(".js-login-cancel").removeClass("hide");var b,g;o.isMobile?(b="app",g="wsc",o.isWxd()?g="wxd":o.isWsc()?g="wsc":o.isPf()?g="pf":b="wap"):b="pc";var v=new e({el:$(".js-change-phone-form"),onTimeChange:function(t){var e=t.second;$(h).text("等待 "+e+"秒")},onTimeEnd:function(){h.text("再次获取"),h.prop("disabled",!1),h.removeClass("disabled"),u.attr("placeholder","没有收到验证码？")},onTimerStart:function(){h.prop("disabled",!0),h.addClass("disabled")},onVerifyPictureError:function(){h.prop("disabled",!1),h.removeClass("disabled"),h.text("再次获取")},onGetCodeError:function(){h.prop("disabled",!1),h.removeClass("disabled"),h.text("再次获取")},onVerifyPictureShow:function(){f.html("操作过于频繁，请先输入图像验证码再获取")},biz:"kdt_account_change_mobile",platform:b,subFrom:g});h.on("click",function(t){t.preventDefault();var e=$.trim(d.val());v.setMobile(e),v.getSms()}),p.click(function(){event.preventDefault(),window.history.back()});var y=$(".js-change-phone-form");y.on("submit",function(t){t.preventDefault();var e=c.getFormData(y);e=s(e),r(e)&&a(e)}),$(".js-goto-login").on("click",function(){i.doAction({action:"back"})})}),define("wap/buyer/change_phone/main",function(){}),define("text!wap/buyer/manage/templates/confirmLogout.html",[],function(){return'<div>\n    <div class="header">\n        <h2 class="center c-green">退出登录</h2>\n    </div>\n    <div class="block border-0" style="padding: 10px 0;line-height: 1.3;">\n        退出后不会删除任何历史数据，但你将只能看到登录前此微信中的订单。\n    </div>\n    <div class="action-container">\n        <div class="btn-2-1">\n            <button class="js-cancel btn btn-green btn-l">取消</button>\n        </div>\n        <div class="btn-2-1">\n            <button class="js-ok btn btn-white btn-l">退出登录</button>\n        </div>\n    </div>\n</div>'}),define("text!wap/buyer/manage/templates/hasBindTips.html",[],function(){return'<div>\n    <div class="block border-0" style="padding: 10px 0;line-height: 1.3;">\n        你的手机号已与另一个微信帐号绑定，请退出登录以查看当前微信下的资产记录。\n    </div>\n    <div class="action-container">\n        <div class="btn-2-1">\n            <button class="js-cancel btn btn-green btn-l">我知道了</button>\n        </div>\n    </div>\n</div>\n'}),require(["bower_components/pop/pop_alert/popout_alert","bower_components/pop/popout_box","./wap/buyer/change_phone/main","zenjs/util/args","text!wap/buyer/manage/templates/confirmLogout.html","text!wap/buyer/manage/templates/hasBindTips.html"],function(t,e,n,i,o,s){function r(){try{window.localStorage.clear()}catch(t){}$("<iframe>").css("display","none").attr("src",window._global.url.trade+"/v2/buyer/auth/logout").appendTo(document.body),$("<iframe>").css("display","none").attr("src",window._global.wap_url.wap+"/buyer/auth/logout").appendTo(document.body),_global.url&&_global.kdt_id&&setTimeout(function(){location.assign(_global.wap_url.wap+"/trades/"+_global.kdt_id)},100)}var a=window._global||{},c={wxBind:"/v2/buyer/user/createbind.json"},l={weixin:"bindwx",qq:"bindqq"};$(".js-wx-bind").on("click",function(e){var n=$(e.target),i=n.html();$._ajax({url:c.wxBind,type:"POST",dataType:"json",timeout:15e3,beforeSend:function(){n.html("确认中..."),n.prop("disabled",!0)},success:function(e){0==+e.code?a.redirect_url&&window.location.assign(a.redirect_url):t.show(e&&e.msg||"很抱歉，绑定失败，请重试",{transparent:.3})},error:function(){t.show("很抱歉，绑定失败，请重试",{transparent:.3})},complete:function(){n.html(i),n.prop("disabled",!1)}})}),$(".js-unbind").on("click",function(){a.redirect_url&&window.location.assign(a.redirect_url)}),$(".js-logout").on("click",function(t){t.preventDefault(),new e({isCanNotHide:!0,html:_.template(o)(),onOKClicked:function(){r()}}).render().show()}),$(".js-go-bind").on("click",function(t){t.preventDefault(),$(t.currentTarget).hasClass("binded")?new e({isCanNotHide:!0,html:_.template(s)()}).render().show():location.assign(a.wap_url.wap+"/buyer/manage/"+(l[a.platform]||"")+"?redirect_uri="+encodeURIComponent(a.wap_url.wap+"/buyer/manage"))})}),define("main",function(){});