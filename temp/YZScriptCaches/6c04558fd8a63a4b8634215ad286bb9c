define("zenjs/util/number",[],function(){return{makeRandomString:function(i){var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";i=i||10;for(var o=0;o<i;o++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}}}),define("bower_components/pop/pop",["require","zenjs/events","zenjs/util/number"],function(i){var t=function(){},n=i("zenjs/events"),o=i("zenjs/util/number");return window.zenjs=window.zenjs||{},n.extend({init:function(i){this._window=$(window);var n=o.makeRandomString();$("body").append('<div id="'+n+'"                 style="display:none; height: 100%;                 position: fixed; top: 0; left: 0; right: 0;                background-color: rgba(0, 0, 0, '+(i.transparent||".7")+');z-index:1000;opacity:0;transition: opacity ease 0.2s;"></div>'),this.nBg=$("#"+n),this.nBg.on("click",$.proxy(function(){this.isCanNotHide||this.hide()},this));var e=o.makeRandomString();$("body").append('<div id="'+e+'" class="'+(i.className||"")+'" style="overflow:hidden;visibility: hidden;"></div>'),this.nPopContainer=$("#"+e),this.nPopContainer.hide(),this.nPopContainer.css({opacity:0,position:"absolute","z-index":1e3}),i.contentViewClass&&(this.contentViewClass=i.contentViewClass,this.contentViewOptions=$.extend({el:this.nPopContainer},i.contentViewOptions||{}),this.contentView=new this.contentViewClass($.extend({onHide:$.proxy(this.hide,this)},this.contentViewOptions)),this.contentView.onHide=$.proxy(this.hide,this)),this.animationTime=i.animationTime||300,this.isCanNotHide=i.isCanNotHide,this.doNotRemoveOnHide=i.doNotRemoveOnHide||!1,this.onShow=i.onShow||t,this.onHide=i.onHide||t,this.onFinishHide=i.onFinishHide||t,this.html=i.html},render:function(i){return this.renderOptions=i||{},this.contentViewClass?this.contentView.render(this.renderOptions):this.html&&this.nPopContainer.html(this.html),this},show:function(){return this.nBg.show().css({opacity:"1","transition-property":"none"}),this.nPopContainer.show(),this.trigger("pop:show:before"),setTimeout($.proxy(function(){this.trigger("pop:show:after"),this.nPopContainer.show().css("visibility","visible"),this._doShow&&this._doShow(),this.onShow()},this),200),this},hide:function(i){i=i||{};var t=i.doNotRemove||this.doNotRemoveOnHide||!1;this._doHide&&this._doHide(),this.trigger("pop:hide:before"),setTimeout($.proxy(function(){this.nBg.css({opacity:0,"transition-property":"opacity"}),this.trigger("pop:hide:after"),setTimeout($.proxy(function(){this.nBg.hide(),this.nPopContainer.hide(),t||this.destroy()},this),200)},this),this.animationTime),this.onHide()},destroy:function(){return this.nPopContainer.remove(),this.nBg.remove(),this.contentView&&this.contentView.remove(),this}})}),define("bower_components/pop/pop_forbid_scroll",["require","./pop"],function(i){return window.zenjs=window.zenjs||{},i("./pop").extend({init:function(i){this._super(i),i.doNotForbidScroll||(this.on("pop:show:before",$.proxy(this.onBeforePopShow,this)),this.on("pop:show:after",$.proxy(this.onAfterPopShow,this)),this.on("pop:hide:after",$.proxy(this.onAfterPopHide,this)))},onBeforePopShow:function(){this.top=this._window.scrollTop()},onAfterPopShow:function(){this._window.scrollTop(0),this.startShow()},onAfterPopHide:function(){var i,t=function(n){if(i!==this._window.scrollTop()&&n>0)return this._window.scrollTop(i),void setTimeout($.proxy(t,this,n-1));setTimeout($.proxy(this.onFinishHide,this),50)};return function(){this.startHide(),i=this.top,this._window.scrollTop(i),$.proxy(t,this)(2),setTimeout($.proxy(function(){window.zenjs.popList.length<1&&$("html").css("position",this.htmlPosition)},this),200)}}(),startShow:function(){var i=window.zenjs.popList;if(i||(i=window.zenjs.popList=[]),0===i.length){var t=$("body"),n=$("html");this.htmlPosition=n.css("position"),n.css("position","relative"),this.bodyCss=(t.prop("style")||{}).cssText,this.htmlCss=(n.prop("style")||{}).cssText,$("body,html").css({overflow:"hidden",height:this._window.height(),"padding-bottom":0,"margin-bottom":0})}i.indexOf(this)<0&&i.push(this)},startHide:function(){var i=window.zenjs.popList,t=i.indexOf(this);t>-1&&i.splice(t,1),i.length<1&&($("html").attr("style",this.htmlCss||""),$("body").attr("style",this.bodyCss||""))}})}),define("bower_components/pop/popout",["require","./pop_forbid_scroll"],function(i){return i("./pop_forbid_scroll").extend({init:function(i){i=i||{},this._super(i),this.css=$.extend({transition:"opacity ease "+this.animationTime+"ms",top:"50%",left:"50%","-webkit-transform":"translate3d(-50%, -50%, 0)",transform:"translateY(-50%, -50%, 0)"},i.css||{}),this.nPopContainer.css(this.css)},_doShow:function(){$(".js-popout-close").click($.proxy(function(i){this.hide()},this)),this.nPopContainer.css("opacity",1),this.nPopContainer.show()},_doHide:function(i){this.nPopContainer.css({opacity:0})}})}),define("bower_components/pop/popout_box",["require","./popout"],function(i){var t=function(){};return i("./popout").extend({init:function(i){this._super(i),this._onOKClicked=i.onOKClicked||t,this._onCancelClicked=i.onCancelClicked||t,this.preventHideOnOkClicked=i.preventHideOnOkClicked||!1,this.width=i.width,this.setEventListener()},setEventListener:function(){this.nPopContainer.on("click",".js-ok",$.proxy(this.onOKClicked,this)),this.nPopContainer.on("click",".js-cancel",$.proxy(this.onCancelClicked,this))},_doShow:function(){this.boxCss={"border-radius":"4px",background:"white",width:this.width||"270px",padding:"15px"},this.nPopContainer.css(this.boxCss).addClass("popout-box"),this._super()},_doHide:function(i){this._super()},onOKClicked:function(i){this._onOKClicked(i),!this.preventHideOnOkClicked&&this.hide()},onCancelClicked:function(i){this._onCancelClicked(i),this.hide()}})}),define("text!wap/ump/lucky_money_result/templates/success.html",[],function(){return'<div class="wx-sync-success">\n    <h3>已成功添加到卡包</h3>\n    <% if(sale_msg) { %>\n    <div class="card-sale-msg">\n        <pre><%= sale_msg %></pre>\n    </div>\n    <% } %>\n    <div class="text-center">\n        <a href="<%= homepage_link %>" class="btn btn-orange btn-large js-ok">去逛逛挑好货</a>\n        <% if(can_share) { %>\n        <button type="button" class="js-share btn btn-white btn-large">分享给好友</button>\n        <% } %>\n    </div>\n</div>\n'}),require(["bower_components/pop/popout_box","text!wap/ump/lucky_money_result/templates/success.html","zenjs/util/ua","bower_components/youzanjsbridge/api"],function(i,t,n,o){var e=window.wx;new(Backbone.View.extend({successTemplate:_.template(t),events:{"click .js-tj-use":"onTjUseClick","click .js-sync-weixin":"onSyncWeixinClick","click .js-share":"onShareClick","click .js-show-instruction":"onShowInstructionClick"},initialize:function(i){this.ui={},this.ui.qrcodeContainer=this.$(".js-qrcode-container"),"youzanwxd"==_global.platform&&n.isIOS()&&o.putData("goodsInfo",{goods_id:"http://img.yzcdn.cn/public_files/2015/11/04/0ce3ac31b71052c2b63d5753c034d576.gif"})},render:function(){return this},log:function(i){_(i).extend({target:"wxd"}),window.Logger&&window.Logger.log(i)},onTjUseClick:function(){this.log({kdt_id:window._global.kdt_id,fm:"click",title:"1111立即使用"})},onSyncWeixinClick:function(i){i.preventDefault(),this.log({kdt_id:window._global.kdt_id,fm:"click",title:"1111添加卡包"}),n.isWeixin()?this.addCardWithSDK():this.showQrcode()},addCardWithSDK:function(){var i=this,t=window._global;e.addCard({cardList:[{cardId:t.card_id||"",cardExt:t.jssdk_add_card_data||""}],complete:function(i){},fail:function(t){i.showQrcode()},cancel:function(n){t.is_sync_card||i.showQrcode(!0)},success:function(n){t.is_sync_card=!0,i.showSuccessModal()}})},showQrcode:function(i){i&&this.ui.qrcodeContainer.find(".card-qrcode").addClass("with-error"),n.isIOS()?this.showQrcodeModal():this.ui.qrcodeContainer.addClass("active")},showQrcodeModal:function(){var t=this.ui.qrcodeContainer.html();new i({html:t}).render().show()},showSuccessModal:function(){var t=window._global;if(!t.is_sync_card)return!1;var n=this.successTemplate({sale_msg:"大钱小钱都是爱<br />红包已到手，赶紧使用吧！",homepage_link:t.shopping_url||t.wap_url.wap+"/showcase/homepage?kdt_id="+t.kdt_id,can_share:!window._global.share.notShare});new i({html:n}).render().show()},onShareClick:function(i){i.preventDefault(),window.showGuide("share"),this.log({kdt_id:window._global.kdt_id,fm:"click",title:"1111分享"})}}))({el:$("body")}).render()}),define("main",function(){});