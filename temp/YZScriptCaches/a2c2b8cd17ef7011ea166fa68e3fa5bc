define("zenjs/util/number",[],function(){return{makeRandomString:function(t){var n="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t=t||10;for(var e=0;e<t;e++)n+=i.charAt(Math.floor(Math.random()*i.length));return n}}}),define("bower_components/pop/pop",["require","zenjs/events","zenjs/util/number"],function(t){var n=function(){},i=t("zenjs/events"),e=t("zenjs/util/number");return window.zenjs=window.zenjs||{},i.extend({init:function(t){this._window=$(window);var i=e.makeRandomString();$("body").append('<div id="'+i+'"                 style="display:none; height: 100%;                 position: fixed; top: 0; left: 0; right: 0;                background-color: rgba(0, 0, 0, '+(t.transparent||".7")+');z-index:1000;opacity:0;transition: opacity ease 0.2s;"></div>'),this.nBg=$("#"+i),this.nBg.on("click",$.proxy(function(){this.isCanNotHide||this.hide()},this));var o=e.makeRandomString();$("body").append('<div id="'+o+'" class="'+(t.className||"")+'" style="overflow:hidden;visibility: hidden;"></div>'),this.nPopContainer=$("#"+o),this.nPopContainer.hide(),this.nPopContainer.css({opacity:0,position:"absolute","z-index":1e3}),t.contentViewClass&&(this.contentViewClass=t.contentViewClass,this.contentViewOptions=$.extend({el:this.nPopContainer},t.contentViewOptions||{}),this.contentView=new this.contentViewClass($.extend({onHide:$.proxy(this.hide,this)},this.contentViewOptions)),this.contentView.onHide=$.proxy(this.hide,this)),this.animationTime=t.animationTime||300,this.isCanNotHide=t.isCanNotHide,this.doNotRemoveOnHide=t.doNotRemoveOnHide||!1,this.onShow=t.onShow||n,this.onHide=t.onHide||n,this.onFinishHide=t.onFinishHide||n,this.html=t.html},render:function(t){return this.renderOptions=t||{},this.contentViewClass?this.contentView.render(this.renderOptions):this.html&&this.nPopContainer.html(this.html),this},show:function(){return this.nBg.show().css({opacity:"1","transition-property":"none"}),this.nPopContainer.show(),this.trigger("pop:show:before"),setTimeout($.proxy(function(){this.trigger("pop:show:after"),this.nPopContainer.show().css("visibility","visible"),this._doShow&&this._doShow(),this.onShow()},this),200),this},hide:function(t){t=t||{};var n=t.doNotRemove||this.doNotRemoveOnHide||!1;this._doHide&&this._doHide(),this.trigger("pop:hide:before"),setTimeout($.proxy(function(){this.nBg.css({opacity:0,"transition-property":"opacity"}),this.trigger("pop:hide:after"),setTimeout($.proxy(function(){this.nBg.hide(),this.nPopContainer.hide(),n||this.destroy()},this),200)},this),this.animationTime),this.onHide()},destroy:function(){return this.nPopContainer.remove(),this.nBg.remove(),this.contentView&&this.contentView.remove(),this}})}),define("bower_components/pop/pop_forbid_scroll",["require","./pop"],function(t){return window.zenjs=window.zenjs||{},t("./pop").extend({init:function(t){this._super(t),t.doNotForbidScroll||(this.on("pop:show:before",$.proxy(this.onBeforePopShow,this)),this.on("pop:show:after",$.proxy(this.onAfterPopShow,this)),this.on("pop:hide:after",$.proxy(this.onAfterPopHide,this)))},onBeforePopShow:function(){this.top=this._window.scrollTop()},onAfterPopShow:function(){this._window.scrollTop(0),this.startShow()},onAfterPopHide:function(){var t,n=function(i){if(t!==this._window.scrollTop()&&i>0)return this._window.scrollTop(t),void setTimeout($.proxy(n,this,i-1));setTimeout($.proxy(this.onFinishHide,this),50)};return function(){this.startHide(),t=this.top,this._window.scrollTop(t),$.proxy(n,this)(2),setTimeout($.proxy(function(){window.zenjs.popList.length<1&&$("html").css("position",this.htmlPosition)},this),200)}}(),startShow:function(){var t=window.zenjs.popList;if(t||(t=window.zenjs.popList=[]),0===t.length){var n=$("body"),i=$("html");this.htmlPosition=i.css("position"),i.css("position","relative"),this.bodyCss=(n.prop("style")||{}).cssText,this.htmlCss=(i.prop("style")||{}).cssText,$("body,html").css({overflow:"hidden",height:this._window.height(),"padding-bottom":0,"margin-bottom":0})}t.indexOf(this)<0&&t.push(this)},startHide:function(){var t=window.zenjs.popList,n=t.indexOf(this);n>-1&&t.splice(n,1),t.length<1&&($("html").attr("style",this.htmlCss||""),$("body").attr("style",this.bodyCss||""))}})}),define("bower_components/pop/popout",["require","./pop_forbid_scroll"],function(t){return t("./pop_forbid_scroll").extend({init:function(t){t=t||{},this._super(t),this.css=$.extend({transition:"opacity ease "+this.animationTime+"ms",top:"50%",left:"50%","-webkit-transform":"translate3d(-50%, -50%, 0)",transform:"translateY(-50%, -50%, 0)"},t.css||{}),this.nPopContainer.css(this.css)},_doShow:function(){$(".js-popout-close").click($.proxy(function(t){this.hide()},this)),this.nPopContainer.css("opacity",1),this.nPopContainer.show()},_doHide:function(t){this.nPopContainer.css({opacity:0})}})}),define("bower_components/pop/popout_box",["require","./popout"],function(t){var n=function(){};return t("./popout").extend({init:function(t){this._super(t),this._onOKClicked=t.onOKClicked||n,this._onCancelClicked=t.onCancelClicked||n,this.preventHideOnOkClicked=t.preventHideOnOkClicked||!1,this.width=t.width,this.setEventListener()},setEventListener:function(){this.nPopContainer.on("click",".js-ok",$.proxy(this.onOKClicked,this)),this.nPopContainer.on("click",".js-cancel",$.proxy(this.onCancelClicked,this))},_doShow:function(){this.boxCss={"border-radius":"4px",background:"white",width:this.width||"270px",padding:"15px"},this.nPopContainer.css(this.boxCss).addClass("popout-box"),this._super()},_doHide:function(t){this._super()},onOKClicked:function(t){this._onOKClicked(t),!this.preventHideOnOkClicked&&this.hide()},onCancelClicked:function(t){this._onCancelClicked(t),this.hide()}})}),define("text!bower_components/pop/pop_alert/box.html",[],function(){return'<div class="alert-content font-size-14" style="line-height: 1.4; padding: 5px 0;">\n    <%= data.box_content %>\n</div>\n<hr style="margin: 10px 0 11px;">\n<p class="js-ok confirm center c-green" style="line-height: 22px;">\n    <%= data.box_confirm %>\n</p>'}),define("zenjs/util/template",["require","jquery"],function(t){var n=t("jquery"),i=function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},n=["&","<",">",'"',"'"],i=new RegExp("["+n.join("")+"]","g");return function(n){return null==n?"":(""+n).replace(i,function(n){return t[n]})}}(),e={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},o={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};return function(t,s,r){var p;r=n.extend({},e,r);var h=new RegExp([(r.escape||/(.)^/).source,(r.interpolate||/(.)^/).source,(r.evaluate||/(.)^/).source].join("|")+"|$","g"),c=0,a="__p+='";t.replace(h,function(n,i,e,s,r){return a+=t.slice(c,r).replace(/\\|'|\r|\n|\t|\u2028|\u2029/g,function(t){return"\\"+o[t]}),i&&(a+="'+\n((__t=("+i+"))==null?'':escapeFunc(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),s&&(a+="';\n"+s+"\n__p+='"),c=r+n.length,n}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{p=new Function(r.variable||"obj","escapeFunc",a)}catch(t){throw t.source=a,t}if(s)return p(s,i);var d=function(t){return p.call(this,t,i)};return d.source="function("+(r.variable||"obj")+"){\n"+a+"}",d}}),define("bower_components/pop/pop_alert/popout_alert",["require","../popout_box","text!../pop_alert/box.html","zenjs/util/template"],function(t){var n=t("../popout_box"),i=t("text!../pop_alert/box.html"),e=t("zenjs/util/template"),o=e(i),s=n.extend({init:function(t){this._super(t),this.isCanNotHide=!0,this.box_content=t.content||"",this.box_confirm=t.confirmText||"我知道了"},render:function(t){return this.html||(this.html=o({data:{box_content:this.box_content,box_confirm:this.box_confirm}})),this._super(t),this.nPopContainer.addClass("popout-alert"),this},_doShow:function(){this._super()},_doHide:function(t){this._super()}}),r=null;return{show:function(t,n){n=n||{},r&&this.hide(),n.content=t,r=new s(n).render().show()},hide:function(){r&&(r.hide(),r=null)}}}),define("text!bower_components/pop/pop_confirm/box.html",[],function(){return'<% if (title) { %>\n<h1 class="center font-size-16"><%= title %></h1>\n<% } %>\n<div class="confirm-content font-size-14<% if (title) { %> c-gray-dark<% } %>" style="line-height: 20px; padding: 5px 5px 10px;">\n    <%= content %>\n</div>\n<hr style="margin: 9px -15px 10px;" />\n<div class="btn-2-1">\n    <p class="js-cancel center font-size-16" style="padding-top: 5px;"><%= cancelBtn %></p>\n</div><div class="btn-2-1">\n    <p class="js-ok center c-green font-size-16" style="padding-top: 5px;"><%= okBtn %></p>\n</div>'}),define("bower_components/pop/pop_confirm/popout_confirm",["require","../popout_box","text!../pop_confirm/box.html","zenjs/util/template"],function(t){var n=t("../popout_box"),i=t("text!../pop_confirm/box.html"),e=t("zenjs/util/template"),o=e(i),s=n.extend({init:function(t){this._super(t),this.isCanNotHide=!0,this.title=t.title||"",this.content=t.content||"",this.okBtn=t.okBtn||"确定",this.cancelBtn=t.cancelBtn||"取消"},render:function(t){return this.html||(this.html=o({title:this.title,content:this.content,okBtn:this.okBtn,cancelBtn:this.cancelBtn})),this._super(t),this.nPopContainer.addClass("popout-confirm"),this}}),r=null;return{show:function(t,n){n=n||{},r&&this.hide(),n.content=t,r=new s(n).render().show()},hide:function(){r&&(r.hide(),r=null)}}}),require(["zenjs/util/args","bower_components/pop/pop_alert/popout_alert","bower_components/pop/pop_confirm/popout_confirm"],function(t,n,i){new(Backbone.View.extend({initialize:function(t){},events:{"click .js-dispense-card":"handleDispenseCard"},handleDispenseCard:function(t){var e=$(t.target).data(),o={1:"你确定发放此会员卡吗？规则卡只保有一张，新卡会替换旧卡",3:"你确定发放此会员卡吗？"};e.isown?n.show("客户已获得的会员卡，暂不支持取消。",{title:"提示"}):i.show(o[e.type],{title:"提示",onOKClicked:_.bind(function(){this.saveDispenseCard(e)},this)})},saveDispenseCard:function(n){$._ajax({url:"/v2/card/membercard/GiveCard.json",type:"POST",data:{card_alias:n.alias,yz_uid:t.get("yz_uid"),fans_id:_global.fans_id,fans_type:_global.fans_type,buyer_id:_global.buyer_id,access_token:t.get("access_token")},success:function(i){0===i.code?window.location.href=t.add(_global.url.wap+"/card/membercard/usercardlist",{card_alias:n.alias,yz_uid:t.get("yz_uid"),access_token:t.get("access_token"),fans_id:_global.fans_id,fans_type:_global.fans_type,buyer_id:_global.buyer_id}):motify.log(i.msg||"网络错误")},error:function(t){motify.log(t.msg||"网络错误")}})},render:function(){return this}}))({el:$("body")})}),define("main",function(){});