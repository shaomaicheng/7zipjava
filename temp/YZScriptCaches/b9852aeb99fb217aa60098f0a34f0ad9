define("zenjs/util/event",["require","jquery"],function(t){var i=t("jquery"),e={getTargetByDataKey:function(t,e){for(var s=i(t.target);!s.data(e)&&0!==s.data(e)&&"BODY"!=(s[0]||{}).nodeName;)s=s.parent();return s},getEventHandler:function(){var t=function(){};return i.extend(!0,t.prototype,e.methods),new t},methods:{events:{},on:function(t,i){return"string"==typeof t&&"[object Function]"===Object.prototype.toString.call(i)&&(this.events[t]||(this.events[t]=[]),this.events[t].push(i))},trigger:function(t){if("string"!=typeof t)return!1;if(!this.events[t])return this.events[t]=[],!1;for(var i=this.events[t],e=Array.prototype.slice.apply(arguments,[1]),s=0,n=i.length;s<n;s++)i[s](e)},off:function(t,i){if(!t&&!i)return void(this.events={});if(!i)return void(this.events[t]=[]);var e=this.events[t],s=e.indexOf(i);e.splice(s,1)}}};return e}),define("zenjs/backbone/tabber",["require","../util/event","backbone"],function(t){var i=t("../util/event"),e=t("backbone"),s=function(){};return e.View.extend({initialize:function(t){this.activeKey=t.activeKey||"type",this.activeClass=t.activeClass||"active",this.hashAsDefaultData=!!t.hashAsDefaultData,this.cbOnClicked=t.onClicked||s,this.cbOnDisabledClicked=t.onDisabledClicked||s,this.initDefault(t)},events:{click:"onClicked"},initDefault:function(t){var i=e.history.getHash();t.hashAsDefaultData&&i?this.active(i):t.defaultData&&t.defaultData.length>0&&this.active(t.defaultData)},onClicked:function(t){if(t.target&&0!==t.target.length){var e=i.getTargetByDataKey(t,this.activeKey),s=""+e.data(this.activeKey);if(void 0===this.firstClick?this.firstClick=!0:this.firstClick=!1,e.blur(),s&&"undefined"!==s&&this.activeData!==s&&s&&s.length>0){if(this.disabled===!0)return void(this.activeData!==s&&this.cbOnDisabledClicked());if(this.hashAsDefaultData){var n=location.href.replace(/(javascript:|#).*$/,"");location.replace(n+"#"+s)}this.$("."+this.activeClass).removeClass(this.activeClass),e.addClass(this.activeClass),this.activeData=s,this.cbOnClicked(_.extend(t||{},{value:s,nTarget:e}))}}},active:function(t,i){this.onClicked(_.extend({target:this.$el.find("[data-"+this.activeKey+'="'+t+'"]:first')},i||{}))},setDisable:function(t){this.disabled=t},setData:function(t){this.activeData=t,this.$("."+this.activeClass).removeClass(this.activeClass),this.$el.find("[data-"+this.activeKey+'="'+this.activeData+'"]:first').addClass(this.activeClass)},getData:function(){return this.activeData}})}),define("wap/showcase/modules/goods_list/box_stream",[],function(){var t=function(t){this._conf={container:null,rowCount:4,rowContainerClassName:"",rowContainerTagType:"div",rowCintainerWidths:[],_rowContainers:[]},t&&this.init(t)};return t.prototype={init:function(t){t=this._conf=$.extend(this._conf,t||{}),this._initRowContainers(t)},_initRowContainers:function(t){var i,e,s,n,s=$(t.container).children();for(t.inialChildren=s,n=t.rowCount,i=0;i<n;i++)e=document.createElement(t.rowContainerTagType),e.className=t.rowContainerClassName,e.style.cssText="float:left;z-index:"+(n-i),t.rowCintainerWidths[i]&&(e.style.width=t.rowCintainerWidths[i]+"px"),t.container.insertBefore(e,s[0]),t._rowContainers[i]=e;i=null,e=null,s=null,n=null},setListData:function(t){var e=this._conf,s=e._rowContainers,t=t||e.inialChildren,n=e.rowCount;for(i=0;i<t.length;i++)s[i%n].appendChild(t[i]);s=null},_sortOut:function(){var t,i,e,s,n=this._conf,a=n._rowContainers,o=0,h=0,r=0,l=-1;for(i=0;i<a.length;i++)t=a[i].offsetHeight,t>r&&(r=t,o=i),(l<0||t<l)&&(l=t,h=i);return(s=$(a[o]).children().last()[0])?(t=s.offsetHeight,r-l>t?(a[h].appendChild(s),e=!(a[h].offsetHeight>=r)):e=!1,n=null,a=null,o=null,h=null,r=null,l=null,t=null,i=null,s=null,e):e=!1},sortOut:function(t){for(;this._sortOut(););"function"==typeof t&&t()}},t}),define("bower_components/waterfall/pager",["require","zenjs/events"],function(t){var i=t("zenjs/events"),e=function(){};return i.extend({init:function(t){this.$el||(this.$el=$(t.el||t.$el||"<div></div>"),this.el=this.$el[0]),this.nLoading=t.loadingHTML?$(t.loadingHTML).addClass("loading-more"):$('<div class="loading-more"><span></span></div>'),this.nList=this.$el.find(".js-list"),0===this.nList.length&&(this.nList=$('<div class="js-list b-list"></div>'),this.$el.append(this.nList)),"number"==typeof t.total&&(this.total=t.total),this.offset=t.offset||300,this.scrollDirection="down",this.pageIndex=t.pageIndex||0,this.perPage=t.perPage||10,this.postData=t.postData||{},this.checkSize=!0,"boolean"==typeof t.checkSize&&(this.checkSize=t.checkSize),this.idName=t.idName||"id",t.idValue&&(this.idValue=t.idValue),this.jsonKeys=t.jsonKeys||{},this.finishedHTML=t.finishedHTML,this.finishedText=t.finishedText,this.emptyHTML=t.emptyHTML||"",this.emptyText=t.emptyText||"",this.getExtrPostData=t.getExtrPostData||e,this.onFetchError=t.onFetchError||e,this.onListEmpty=this.onListEmpty||t.onEmpty||this._onListEmpty,this.on("finished",t.onFinished||e),this.on("after:list:load",t.onAfterListLoad||t.onDataLoad||e),this.extraData={},this.scrollContainer=t.scrollContainer?$(t.scrollContainer):$("body"),this.scrollEventAccepter=t.scrollEventAccepter?$(t.scrollEventAccepter):$(t.scrollContainer||window),this._onScroll=$.proxy(this.onScroll,this),this.bindScrollFunc()},$:function(t){return this.$el.find(t)},onScroll:function(){function t(){var t=this.nList.offset(),i=this.scrollContainer.offset();return{left:t.left-i.left||0,top:t.top-i.top||0}}return function(){if(!(this.sleeping||this.finished||this.fetching)){if(0===this.total||this.total&&this.total<=this.pageIndex*this.perPage)return void this.doFinishLoading();var i=t.call(this);"down"===this.scrollDirection&&this.nList.height()+i.top-this.scrollEventAccepter.height()-this.scrollContainer.scrollTop()<this.offset&&this.fetchMore&&this.fetchMore(),"up"===this.scrollDirection&&this.scrollContainer.scrollTop()<this.offset&&this.fetchMore&&this.fetchMore()}}}(),fetchMore:function(){return this.sleeping||this.finished||this.fetching?this:(this.showLoading(),this.fetching=!0,this._fetchMore&&this._fetchMore.call(this),this)},onFetchMoreSuccess:function(){this.hideLoading(),this.fetching=!1,this._onFetchMoreSuccess.apply(this,arguments)},fetchRender:function(){return this.fetchMore(),this},_onFetchMoreError:function(){this.fetching=!1,this.hideLoading(),this.onFetchError()},doFinishLoading:function(t){this.finished=!0,this.fetching=!1,this.hideLoading(),this.$el.find(".list-finished").remove(),this.triggerMethod&&this.triggerMethod("finished",this.collection,t)},bindScrollFunc:function(){var t=this;this.scrollFunc&&this.unbindScrollFunc(),this.scrollFunc=function(){t.scrollTimeout&&clearTimeout(t.scrollTimeout),t.scrollTimeout=setTimeout(t._onScroll,200)},this.scrollEventAccepter.on("scroll",this.scrollFunc)},unbindScrollFunc:function(){this.scrollEventAccepter.off("scroll",this.scrollFunc),this.scrollFunc=null},doSleep:function(){this.sleeping=!0,this.unbindScrollFunc()},doWake:function(){this.sleeping=!1,this.bindScrollFunc(),this.fetchMore()},showLoading:function(){this.hasFetching=!0,this.$el.append(this.nLoading)},hideLoading:function(){this.nLoading.remove()},getFinishHtml:function(){return this.finishedHTML?$(this.finishedHTML).addClass("list-finished"):'<div class="list-finished">'+(this.finishedText||"已经没有更多了")+"</div>"},setExtraData:function(t){$.extend(this.extraData,t)},resetWaterfall:function(t){this.finished===!0&&this.$(".list-finished").remove(),this.removeAll&&this.removeAll(),this.nList.empty(),this.collection&&this.collection.reset([],{silent:!0}),this.listEl&&this.listEl.empty(),this.finished=!1,t&&t.pageIndex?this.pageIndex=t.pageIndex:this.pageIndex=0,this.idValue=void 0},_onListEmpty:function(){if(!this.fetching){var t;this.emptyHTML?t=$(this.emptyHTML).addClass("list-finished"):this.emptyText&&(t='<div class="list-finished">'+this.emptyText+"</div>"),this.$el.append(t)}},destroy:function(){this.doSleep(),this.$el.remove(),this.unbindScrollFunc()},remove:function(){this.destroy()}})}),define("bower_components/waterfall/waterfall_html",["require","bower_components/ajax/ajax","jquery","./pager"],function(t){t("bower_components/ajax/ajax");var i=t("jquery"),e=t("./pager");return e.extend({init:function(t){this.$el&&this.$el.find(".list-finished")&&this.$el.find(".list-finished").length>0||(this._super(t),void 0!==t.pageIndex?this.pageIndex=+t.pageIndex:this.pageIndex=1,this.url=t.url||"",this.ajaxType=t.ajaxType||"GET",this.dataType=t.dataType||"json",this.on("finished",this._doFinishLoading),this.onScroll())},_fetchMore:function(){var t=this,e={};this.perPage&&(e[this.jsonKeys.perPage||"perpage"]=this.perPage),this.idValue?e[this.idName]=this.idValue:e[this.jsonKeys.pageIndex||"page"]=this.pageIndex+1;var s=this.getExtrPostData?this.getExtrPostData():{};i._ajax({url:t.url,type:t.ajaxType,dataType:t.dataType,data:i.extend({},t.postData,e,s,t.extraData),timeout:5e3,success:function(i){t.pageIndex++,i&&0==i.code?t.onFetchMoreSuccess({},i||{}):t.doFinishLoading(i)},error:function(i,e,s){t._onFetchMoreError()}})},_onFetchMoreSuccess:function(t,i){var e=(i||{}).data||{};if(e[this.idName]&&(this.idValue=e[this.idName]),this.triggerMethod("after:list:load",e.html||"",i),!e.html)return this.pageIndex--,void this.doFinishLoading(i);this.onScroll()},_doFinishLoading:function(){if(0==this.pageIndex&&this.triggerMethod("list:empty"),this.hasFetching&&this.pageIndex>2){var t=this.getFinishHtml();this.$el.append(t)}}})}),define("wap/showcase/modules/tags/waterfall_html",["bower_components/waterfall/waterfall_html"],function(t){return t.extend({showFinished:function(t,i,e){if(this.finished=!0,this.removeLoading(),0===this.pageIndex){var s=this.finishedHTML||"没有商品";arguments.length>0&&i&&(s="网络请求失败！<br/><br/>Error Type: "+i),this.nList.after('<div class="list-finished">'+s+"</div>")}this.onFinished()}})}),define("wap/showcase/modules/tags/side_nav",["require","zenjs/util/ua"],function(t){var i=t("zenjs/util/ua");return Backbone.View.extend({el:".js-page-nav-block",events:{"click a[data-alias]":"handleTagsClick","touchmove .transparent-layer":"handleMaskTouchMove"},initialize:function(t){this.initSideNavScroll(),this.options=t||{}},initSideNavScroll:function(){window.lib.scroll({downgrade:!1,useFrameAnimation:!0,scrollWrap:document.getElementById("J_nav_tags_wrap"),scrollElement:document.getElementById("J_nav_tags_con"),noBounce:!1,inertia:"normal",direction:"y"}).init()},show:function(t){var e=i.isIOS()?"slider-show-ios":"slider-to-show";this.active(t),this.$el.find(".side-nav-wrap").addClass(e),this.$el.find(".transparent-layer").show().one("click",_.bind(this.hide,this)),$("body").css({height:$(window).height(),overflow:"hidden"})},hide:function(){var t=i.isIOS()?"slider-show-ios":"slider-to-show";this.$el.find(".side-nav-wrap").removeClass(t),this.$el.find(".transparent-layer").hide(),$("body").css({height:"auto",overflow:"auto"})},handleTagsClick:function(t){var i=$(t.target).data("alias"),e=$(t.target).data("index")+"";this.hide(),this.options.callback({index:e,alias:i})},handleMaskTouchMove:function(t){return t.preventDefault(),t.stopPropagation(),!1},active:function(t){this.$el.find("a[data-index]").removeClass("current"),this.$el.find("a[data-index="+t+"]").addClass("current")}})}),define("wap/showcase/modules/goods_list/compute_height",[],function(){"use strict";return function(t){function i(t,i){t.find(".js-goods-card .photo-block").each(function(t,s){if(0===i||2===i&&t%3==0){var n=$(s),a=e(n);a=a>500?500:a,+a>0&&n.height(a)}})}function e(t){var i=t.width(),e=t.data("width");return e=e<i?i:e,t.data("height")*(i/e)}function s(t,i){if(3!==t&&"waterfall"!==i){return 0===t&&o>500?245:o>500?176:143}}function n(t,i){var s=0;h=h||t[0].width();for(var n=t.length-1;n>=0;n--){var a=e(t[n]);if((s=Math.max(s,a))>i||0===a){s=i;break}}if(s!=i)for(var n=t.length-1;n>=0;n--)t[n].height(s).css("padding-top",0)}function a(t,i){var e=[],s=[];return 1==i&&t.find(".js-goods-card .photo-block").each(function(t,i){s.push($(i)),o<500&&t%2!=1||o>500&&t%3!=2||(e.push(s),s=[])}),2==i&&o<500&&t.find(".js-goods-card .photo-block").each(function(t,i){t%3!=0&&(s.push($(i)),t%3!=1&&(e.push(s),s=[]))}),0===i&&o>500&&t.find(".js-goods-card .photo-block").each(function(t,i){s.push($(i)),t%2==1&&(e.push(s),s=[])}),s.length>0&&e.push(s),s=[],e}var o,h;t.each(function(t,e){var h=$(e),r=+h.data("size"),l=h.data("showtype");o=o||h.width(),0==h.find("li").length&&h.addClass("hide");var d=s(r,l);if(!d)return h.css("visibility","visible"),void h.prev(".js-goods-list-loading").remove();for(var c=a(h,r),f=0,u=c.length;f<u;f++)n(c[f],d);0!==r&&2!==r||i(h,r),h.css("visibility","visible"),h.prev(".js-goods-list-loading").remove()}),$(window).trigger("scroll")}}),define("wap/showcase/modules/goods_list/show_wish_btn",[],function(){"use strict";return function(t){var i=[],e={};t.each(function(t,s){$(s).find(".js-goods-wish").each(function(t,s){var n=$(s),a=n.parent().find(".goods-wish"),o=n.data("id");i.push(o),e[o]=e[o]||[],e[o].push({nWish:a,nWishResponse:n})})}),0!=i.length&&$._ajax({url:"/v2/trade/wish/isAdded.json?kdt_id="+window._global.kdt_id||0,type:"POST",dataType:"json",data:{goods_ids:i},success:function(t){var i=t.data||{};0==+t.code&&$.each(e,function(t,e){i[t]&&i[t].isWishOpen&&$.each(e,function(e,s){var n=s.nWish,a=s.nWishResponse;n.removeClass("hide"),a.removeClass("hide"),i[t].isWishAdded&&(a.removeClass("js-goods-wish").addClass("js-remove-goods-wish"),n.addClass("added-wish"))})})}})}}),define("wap/showcase/modules/tags/tags",["zenjs/util/args","zenjs/backbone/tabber","wap/showcase/modules/goods_list/box_stream","wap/showcase/modules/tags/waterfall_html","wap/showcase/modules/tags/side_nav","wap/showcase/modules/goods_list/compute_height","wap/showcase/modules/goods_list/show_wish_btn"],function(t,i,e,s,n,a,o){var h=function(){};return Backbone.View.extend({events:{"click .js-show-all-tags":"showSideTagNav"},initialize:function(e){this.options=e||{},this.tagHashPrefix="tag_"+(this.options.index+1)+"_",this.isFirstClick=!0,this.WFs={},this.goodsStyleConfig=this.$el.data(),this.tabber=new i({el:this.$(".js-tabber-tags"),defaultData:this.getDefaultData(),activeKey:"tagname",onClicked:_(this.onTabberClicked).bind(this)}),this.luckymoneyUrl="";var s=this;this.$(".js-goto-luckymoney").on("click",function(){var i=function(){window.location.href=s.luckymoneyUrl};s.luckymoneyUrl?i():$._ajax({url:"/v2/fenxiao/77/hongbao.json",method:"get",data:{alias:_global.alias||t.get("alias")},success:function(t){0===t.code?(s.luckymoneyUrl=t.data,i()):window.motify.log("当前人数过多，领取失败，请重新领取")}})});var a=this.$(".js-tabber-tags").find("a").length,o=_global.mp_data&&_global.mp_data.team_type&&"weixiaodian"===_global.mp_data.team_type;a>4&&o&&(this.sideNav=new n({callback:_.bind(this.onSideNavClick,this)}),this.initTagsScroll())},initTagsScroll:function(){this.scroll=window.lib.scroll({downgrade:!1,useFrameAnimation:!0,scrollWrap:document.getElementById("J_tabber_scroll_wrap"),scrollElement:document.getElementById("J_tabber_scroll_con"),noBounce:!1,inertia:"normal",direction:"x",padding:{left:0,right:0}}),this.scroll.init()},showSideTagNav:function(){this.sideNav.show(this.tabber.getData())},onSideNavClick:function(t){var i=this.$el.find("[data-"+this.tabber.activeKey+'="'+t.index+'"]:first').get(0);this.scroll.scrollToElement(i,!0),this.tabber.active(t.index)},getDefaultData:function(){var t,i,e,s,n=this.getTagHash();if(n)for(t=this.$(".js-goods-tag"),i=0,e=t.size();i<e;i++)if(s=this.tagHashPrefix+t.eq(i).data("alias"),n==s)return"tag-"+(i+1);return"tag-1"},onTabberClicked:function(t){var i=t.value,e=this.$(".js-goods-"+i),s=e.data("alias");this.$(".js-goods-tag").addClass("hide"),e.removeClass("hide"),this.showTabContentBox(i,s),this.setTagHash(s)},setTagHash:function(t){if(this.isFirstClick)return void(this.isFirstClick=!1);if(history.replaceState){for(var i=this.getHashArray(),e=!1,s=0;s<i.length;s++)i[s].match(this.tagHashPrefix)&&(i[s]=this.tagHashPrefix+t,e=!0);e||i.push(this.tagHashPrefix+t),i[0]||i.shift(),history.replaceState(null,"","#"+i.join("&"))}},getTagHash:function(){var t,i=this.getHashArray();for(t=0;t<i.length;t++)if(i[t].match(this.tagHashPrefix))return i[t]},getHashArray:function(){var t=location.hash||"";return t=t.replace(/^#/,""),t.split("&")},showTabContentBox:function(t,i){if(!this.WFs[t]){var e="union"!==i?"/v2/showcase/goods/goodsWithTag.json":"/v2/showcase/goods/unionGoods.json",n=_.extend({},this.goodsStyleConfig,{tag_alias:i});"union"===i&&(n.wxd_id=window._global.kdt_id),this.WFs[t]=new s({el:this.$(".js-goods-"+t),perPage:18,pageIndex:0,total:1e3,url:e,postData:n,onDataLoad:this.onWaterFallHtmlLoad})}this.currentWF&&this.currentWF.doSleep(),this.currentWF=this.WFs[t],this.currentWF.doWake()},onWaterFallHtmlLoad:function(){function t(t){t=t||{};var i=!!t.isFirstLoad,s=t.currentWF,n=t.nContent;if(i){s.$("."+t.containerClass).append(t.html);var a,o,h,r=s.$(".js-goods-list"),l=2;a=r.outerWidth(),h=Math.floor(a/2)-5,a>=540?(l=3,o=[176.5,176.5,176.5]):o=a>=360?[h,h]:[155,155],s.box_stream=new e({container:r[0],rowCount:l,rowContainerClassName:"",rowContainerTagType:"li",rowCintainerWidths:o}),s.box_stream.setListData(n)}else s.box_stream.setListData(n);s.box_stream.sortOut()}function i(t){t=t||{},t.currentWF.$("."+t.containerClass).append(t.html);var i=$(".js-goods-list");0!==i.length&&a(i)}var s={waterfall:t,other:i};return function(t){var i=$(t);i.first().hasClass("js-goods-list-loading")&&(i=i.filter(".js-goods-list"));var e=i,n="js-goods-list",a=this,r=!a.list_style;r&&(a.list_style=i.hasClass("waterfall")?"waterfall":"other",n="js-list",e=i.find(".js-goods-card"),i.css("visibility","visible")),$&&$.fn&&$.fn.lazyload&&i.find(".js-goods-lazy").goodsLazyLoad(),e.length<18&&(a.finished=!0),(s[a.list_style]||h)({html:i,nContent:e,isFirstLoad:r,containerClass:n,currentWF:a}),o(i)}}()})}),require(["wap/showcase/modules/tags/tags"],function(t){$(".js-custom-tags").each(function(i){new t({el:this,index:i})})}),define("main",function(){});