define("zenjs/util/number",[],function(){return{makeRandomString:function(t){var n="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t=t||10;for(var e=0;e<t;e++)n+=o.charAt(Math.floor(Math.random()*o.length));return n}}}),define("bower_components/pop/pop",["require","zenjs/events","zenjs/util/number"],function(t){var n=function(){},o=t("zenjs/events"),e=t("zenjs/util/number");return window.zenjs=window.zenjs||{},o.extend({init:function(t){this._window=$(window);var o=e.makeRandomString();$("body").append('<div id="'+o+'"                 style="display:none; height: 100%;                 position: fixed; top: 0; left: 0; right: 0;                background-color: rgba(0, 0, 0, '+(t.transparent||".7")+');z-index:1000;opacity:0;transition: opacity ease 0.2s;"></div>'),this.nBg=$("#"+o),this.nBg.on("click",$.proxy(function(){this.isCanNotHide||this.hide()},this));var i=e.makeRandomString();$("body").append('<div id="'+i+'" class="'+(t.className||"")+'" style="overflow:hidden;visibility: hidden;"></div>'),this.nPopContainer=$("#"+i),this.nPopContainer.hide(),this.nPopContainer.css({opacity:0,position:"absolute","z-index":1e3}),t.contentViewClass&&(this.contentViewClass=t.contentViewClass,this.contentViewOptions=$.extend({el:this.nPopContainer},t.contentViewOptions||{}),this.contentView=new this.contentViewClass($.extend({onHide:$.proxy(this.hide,this)},this.contentViewOptions)),this.contentView.onHide=$.proxy(this.hide,this)),this.animationTime=t.animationTime||300,this.isCanNotHide=t.isCanNotHide,this.doNotRemoveOnHide=t.doNotRemoveOnHide||!1,this.onShow=t.onShow||n,this.onHide=t.onHide||n,this.onFinishHide=t.onFinishHide||n,this.html=t.html},render:function(t){return this.renderOptions=t||{},this.contentViewClass?this.contentView.render(this.renderOptions):this.html&&this.nPopContainer.html(this.html),this},show:function(){return this.nBg.show().css({opacity:"1","transition-property":"none"}),this.nPopContainer.show(),this.trigger("pop:show:before"),setTimeout($.proxy(function(){this.trigger("pop:show:after"),this.nPopContainer.show().css("visibility","visible"),this._doShow&&this._doShow(),this.onShow()},this),200),this},hide:function(t){t=t||{};var n=t.doNotRemove||this.doNotRemoveOnHide||!1;this._doHide&&this._doHide(),this.trigger("pop:hide:before"),setTimeout($.proxy(function(){this.nBg.css({opacity:0,"transition-property":"opacity"}),this.trigger("pop:hide:after"),setTimeout($.proxy(function(){this.nBg.hide(),this.nPopContainer.hide(),n||this.destroy()},this),200)},this),this.animationTime),this.onHide()},destroy:function(){return this.nPopContainer.remove(),this.nBg.remove(),this.contentView&&this.contentView.remove(),this}})}),define("bower_components/pop/pop_forbid_scroll",["require","./pop"],function(t){return window.zenjs=window.zenjs||{},t("./pop").extend({init:function(t){this._super(t),t.doNotForbidScroll||(this.on("pop:show:before",$.proxy(this.onBeforePopShow,this)),this.on("pop:show:after",$.proxy(this.onAfterPopShow,this)),this.on("pop:hide:after",$.proxy(this.onAfterPopHide,this)))},onBeforePopShow:function(){this.top=this._window.scrollTop()},onAfterPopShow:function(){this._window.scrollTop(0),this.startShow()},onAfterPopHide:function(){var t,n=function(o){if(t!==this._window.scrollTop()&&o>0)return this._window.scrollTop(t),void setTimeout($.proxy(n,this,o-1));setTimeout($.proxy(this.onFinishHide,this),50)};return function(){this.startHide(),t=this.top,this._window.scrollTop(t),$.proxy(n,this)(2),setTimeout($.proxy(function(){window.zenjs.popList.length<1&&$("html").css("position",this.htmlPosition)},this),200)}}(),startShow:function(){var t=window.zenjs.popList;if(t||(t=window.zenjs.popList=[]),0===t.length){var n=$("body"),o=$("html");this.htmlPosition=o.css("position"),o.css("position","relative"),this.bodyCss=(n.prop("style")||{}).cssText,this.htmlCss=(o.prop("style")||{}).cssText,$("body,html").css({overflow:"hidden",height:this._window.height(),"padding-bottom":0,"margin-bottom":0})}t.indexOf(this)<0&&t.push(this)},startHide:function(){var t=window.zenjs.popList,n=t.indexOf(this);n>-1&&t.splice(n,1),t.length<1&&($("html").attr("style",this.htmlCss||""),$("body").attr("style",this.bodyCss||""))}})}),define("bower_components/pop/popout",["require","./pop_forbid_scroll"],function(t){return t("./pop_forbid_scroll").extend({init:function(t){t=t||{},this._super(t),this.css=$.extend({transition:"opacity ease "+this.animationTime+"ms",top:"50%",left:"50%","-webkit-transform":"translate3d(-50%, -50%, 0)",transform:"translateY(-50%, -50%, 0)"},t.css||{}),this.nPopContainer.css(this.css)},_doShow:function(){$(".js-popout-close").click($.proxy(function(t){this.hide()},this)),this.nPopContainer.css("opacity",1),this.nPopContainer.show()},_doHide:function(t){this.nPopContainer.css({opacity:0})}})}),define("bower_components/pop/popout_box",["require","./popout"],function(t){var n=function(){};return t("./popout").extend({init:function(t){this._super(t),this._onOKClicked=t.onOKClicked||n,this._onCancelClicked=t.onCancelClicked||n,this.preventHideOnOkClicked=t.preventHideOnOkClicked||!1,this.width=t.width,this.setEventListener()},setEventListener:function(){this.nPopContainer.on("click",".js-ok",$.proxy(this.onOKClicked,this)),this.nPopContainer.on("click",".js-cancel",$.proxy(this.onCancelClicked,this))},_doShow:function(){this.boxCss={"border-radius":"4px",background:"white",width:this.width||"270px",padding:"15px"},this.nPopContainer.css(this.boxCss).addClass("popout-box"),this._super()},_doHide:function(t){this._super()},onOKClicked:function(t){this._onOKClicked(t),!this.preventHideOnOkClicked&&this.hide()},onCancelClicked:function(t){this._onCancelClicked(t),this.hide()}})}),define("bower_components/pop/popout_box_ios",["require","./popout_box"],function(t){return t("./popout_box").extend({_doShow:function(){this.boxCss={"border-radius":"4px",background:"white",width:this.width||"290px",padding:"15px 0 0"},this.nPopContainer.css(this.boxCss).addClass("popout-box-ios"),$(".js-popout-close").click($.proxy(function(t){this.hide()},this)),this.nPopContainer.css("opacity",1),this.nPopContainer.show()}})}),define("text!wap/trade/safe/info/templates/closeSafe.html",[],function(){return'<div class="header">\n    <p class="title center c-black font-size-16">关闭退款申请</p>\n</div>\n<p class="content c-gray-dark font-size-14">如你主动关闭正在处理的退款后，你无法再次发起退款申请，请务必谨慎操作。</p>\n<div class="action-container clearfix">\n    <button class="js-ok btn c-black font-size-16">关闭退款</button>\n    <button class="js-cancel btn c-green font-size-16">取消</button>\n</div>'}),define("text!wap/trade/safe/info/templates/applyYouzan.html",[],function(){return'<p class="title center c-black font-size-16">申请有赞客满介入</p>\n<hr style="margin-bottom: 15px;">\n<p class="content c-black font-size-14">如你与卖家协商不一致，可申请有赞客满介入帮你与卖家协商，但最终处理结果以双方实际情况为准。</p>\n<div class="pop-action-container clearfix">\n    <button class="js-ok pull-left btn btn-green font-size-14">申请介入</button>\n    <button class="js-cancel pull-right btn btn-white font-size-14">取消</button>\n</div>'}),define("zenjs/util/count_down",[],function(){function t(t){return t<10?"0"+t:""+t}function n(n,o,e,i,s){var r=0,a=0,h=0,d=0,c=0,l="",p=new Date,u=n.getTime()-p.getTime();if(u<=0)return s.stop(),o({seconds:0,text:"00:00:000",hour:0,min:0,sec:0,msec:0,day:0},{day:t(0),hour:t(0),min:t(0),sec:t(0),msec:t(0)}),void e();u>=864e5&&(r=Math.floor(u/864e5),u-=864e5*r,l+=r+"天"),u>=36e5&&(a=Math.floor(u/36e5),u-=36e5*a,l+=a+"小时"),u>=6e4?(h=Math.floor(u/6e4)%60,d=Math.floor(u/1e3)%60,c=u%1e3):(h=0,d=Math.floor(u/1e3),c=u%1e3),h<10&&(l+="0"),l+=h+"分",d<10&&(l+="0"),l+=d+"秒",c<10?l+="00":c<100&&(l+="0"),"second"!=i&&(l+=c),o({text:l,hour:a,min:h,sec:d,msec:c,day:r},{day:t(r),hour:t(a),min:t(h),sec:t(d),msec:t(c)})}function o(){this.tid=null,this.startTime=null}var e=function(){};return o.prototype={run:function(t){function o(){h.tid=setTimeout(o,"second"==t.step?1e3:50),n(a,s,r,t.step,h)}this.startTime||(this.startTime=Date.now());var i=t.seconds||0,s=t.onTimeChange||e,r=t.onTimeChangeEnd||e;this.startTime+=1e3*i;var a=new Date(this.startTime),h=this;o()},stop:function(){clearTimeout(this.tid)}},o}),require(["bower_components/pop/popout_box","bower_components/pop/popout_box_ios","text!wap/trade/safe/info/templates/closeSafe.html","text!wap/trade/safe/info/templates/applyYouzan.html","zenjs/util/count_down"],function(t,n,o,e,i){var s=function(){},r=_.template(o),a=(_.template(e),Backbone.View.extend({initialize:function(t){this._global=t._global,this.safe_no=this._global.safe_no},render:function(t){var n={201:["back_order","close"],202:["back_order","close"],203:["modify","close","youzan_involve"],205:["close"],206:[],249:[],207:["address_modify","close","youzan_involve"],250:["back_order"],204:["close"]},o={back_order:'<button class="js-info-btn btn btn-block <%= data.highlight ? "btn-green" : "btn-white" %>" data-type="back_order">订单详情</button>',close:'<button class="js-info-btn btn btn-block btn-white" data-type="close">撤销退款申请</button>',modify:'<button class="js-info-btn btn btn-block <%= data.highlight ? "btn-green" : "btn-white" %>" data-type="modify">修改退款申请</button>',youzan_involve:'<button class="js-info-btn btn btn-block <%= data.highlight ? "btn-green" : "btn-white" %>" data-type="youzan_involve">申请有赞客服介入</button>',address_modify:'<button class="js-info-btn btn btn-block <%= data.highlight ? "btn-green" : "btn-white" %>" data-type="address_modify">修改退货信息</button>',agree_buyer:'<button class="js-info-btn btn btn-block <%= data.highlight ? "btn-green" : "btn-white" %>" data-type="agree_return">同意买家退款</button>',reject_buyer:'<button class="js-info-btn btn btn-block <%= data.highlight ? "btn-green" : "btn-white" %>" data-type="reject_return">拒绝退款申请</button>'},e=n,i=e[this._global.order_item_feedback||201]||[],s="";return _.map(i,function(t,n,e){var i=_.template(o[t]);s+=i({data:{highlight:0==n}})}),this.$(".js-action-container").append(s),this.initCountDown(),this},initCountDown:function(){var t=$(".js-time-counter");if(t.length>0){(new i).run({seconds:t.data("countdown"),onTimeChange:function(n){var o=n.day,e=n.hour,i=n.min,s=n.sec;o<10&&(o="0"+o),e<10&&(e="0"+e),i<10&&(i="0"+i),s<10&&(s="0"+s);var r=_.template('<span class="c-orange"><%= day %>天<%= hour %>时<%= min %>分<%= sec %>秒</span>')({day:o,hour:e,min:i,sec:s});t.html(r).show()},step:"second",onTimeChangeEnd:function(){t.html(""),window.location.reload()}})}},events:{"click .js-see-more":"onMoreClick","click .js-info-btn":"onBtnClick"},onMoreClick:function(t){var n=$(t.target);n.parent().find(".js-more-detail").removeClass("hide"),n.remove()},onBtnClick:function(){var t=function(t){var o=function(n){var o=$(n.target);$._ajax({url:"/v2/trade/safe/close.json",type:"post",dataType:"json",data:{safe_no:this.safe_no},beforeSend:function(){t.onBeforeSend(),o.prop("disabled","disabled")},success:function(n,e,i){0==n.code?window.location.reload():(motify.log(n.msg),t.onError(),o.removeAttr("disabled"))},error:function(n,e,i){motify.log("关闭退款失败"),t.onError(),o.removeAttr("disabled")}})};new n({preventHideOnOkClicked:!0,onOKClicked:_(o).bind(this),html:r(),className:"ios info-pop-box"}).render().show()},o=function(t){window.location.href=this._global.url.trade+"/v2/trade/safe/apply?safe_no="+this._global.safe_no},e=function(t){window.location.href=this._global.url.trade+"/v2/trade/safe/involve?safe_no="+this._global.safe_no},i=function(t){window.location.href=this._global.url.trade+"/v2/trade/safe/express?safe_no="+this._global.safe_no},a=function(t){},h=function(t){},d=function(t){window.location.href=this._global.url.trade+"/v2/trade/order/result?order_no="+this._global.order_no},c={close:t,modify:o,youzan_involve:e,address_modify:i,agree_return:a,reject_return:h,back_order:d};return function(t){var n=$(t.target),o=n.data("type");_(c[o]||s).bind(this)({onSuccess:function(){n.removeAttr("disabled")},onBeforeSend:function(){n.prop("disabled","disabled")},onError:function(){n.removeAttr("disabled")}})}}()}));window.app=new a({_global:window._global,el:$("body")}).render()}),define("main",function(){});