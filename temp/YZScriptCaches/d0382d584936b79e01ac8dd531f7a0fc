define("wap/showcase/modules/goods_list/box_stream",[],function(){var t=function(t){this._conf={container:null,rowCount:4,rowContainerClassName:"",rowContainerTagType:"div",rowCintainerWidths:[],_rowContainers:[]},t&&this.init(t)};return t.prototype={init:function(t){t=this._conf=$.extend(this._conf,t||{}),this._initRowContainers(t)},_initRowContainers:function(t){var i,o,n,s,n=$(t.container).children();for(t.inialChildren=n,s=t.rowCount,i=0;i<s;i++)o=document.createElement(t.rowContainerTagType),o.className=t.rowContainerClassName,o.style.cssText="float:left;z-index:"+(s-i),t.rowCintainerWidths[i]&&(o.style.width=t.rowCintainerWidths[i]+"px"),t.container.insertBefore(o,n[0]),t._rowContainers[i]=o;i=null,o=null,n=null,s=null},setListData:function(t){var o=this._conf,n=o._rowContainers,t=t||o.inialChildren,s=o.rowCount;for(i=0;i<t.length;i++)n[i%s].appendChild(t[i]);n=null},_sortOut:function(){var t,i,o,n,s=this._conf,e=s._rowContainers,a=0,r=0,d=0,h=-1;for(i=0;i<e.length;i++)t=e[i].offsetHeight,t>d&&(d=t,a=i),(h<0||t<h)&&(h=t,r=i);return(n=$(e[a]).children().last()[0])?(t=n.offsetHeight,d-h>t?(e[r].appendChild(n),o=!(e[r].offsetHeight>=d)):o=!1,s=null,e=null,a=null,r=null,d=null,h=null,t=null,i=null,n=null,o):o=!1},sortOut:function(t){for(;this._sortOut(););"function"==typeof t&&t()}},t}),define("zenjs/util/number",[],function(){return{makeRandomString:function(t){var i="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t=t||10;for(var n=0;n<t;n++)i+=o.charAt(Math.floor(Math.random()*o.length));return i}}}),define("bower_components/pop/pop",["require","zenjs/events","zenjs/util/number"],function(t){var i=function(){},o=t("zenjs/events"),n=t("zenjs/util/number");return window.zenjs=window.zenjs||{},o.extend({init:function(t){this._window=$(window);var o=n.makeRandomString();$("body").append('<div id="'+o+'"                 style="display:none; height: 100%;                 position: fixed; top: 0; left: 0; right: 0;                background-color: rgba(0, 0, 0, '+(t.transparent||".7")+');z-index:1000;opacity:0;transition: opacity ease 0.2s;"></div>'),this.nBg=$("#"+o),this.nBg.on("click",$.proxy(function(){this.isCanNotHide||this.hide()},this));var s=n.makeRandomString();$("body").append('<div id="'+s+'" class="'+(t.className||"")+'" style="overflow:hidden;visibility: hidden;"></div>'),this.nPopContainer=$("#"+s),this.nPopContainer.hide(),this.nPopContainer.css({opacity:0,position:"absolute","z-index":1e3}),t.contentViewClass&&(this.contentViewClass=t.contentViewClass,this.contentViewOptions=$.extend({el:this.nPopContainer},t.contentViewOptions||{}),this.contentView=new this.contentViewClass($.extend({onHide:$.proxy(this.hide,this)},this.contentViewOptions)),this.contentView.onHide=$.proxy(this.hide,this)),this.animationTime=t.animationTime||300,this.isCanNotHide=t.isCanNotHide,this.doNotRemoveOnHide=t.doNotRemoveOnHide||!1,this.onShow=t.onShow||i,this.onHide=t.onHide||i,this.onFinishHide=t.onFinishHide||i,this.html=t.html},render:function(t){return this.renderOptions=t||{},this.contentViewClass?this.contentView.render(this.renderOptions):this.html&&this.nPopContainer.html(this.html),this},show:function(){return this.nBg.show().css({opacity:"1","transition-property":"none"}),this.nPopContainer.show(),this.trigger("pop:show:before"),setTimeout($.proxy(function(){this.trigger("pop:show:after"),this.nPopContainer.show().css("visibility","visible"),this._doShow&&this._doShow(),this.onShow()},this),200),this},hide:function(t){t=t||{};var i=t.doNotRemove||this.doNotRemoveOnHide||!1;this._doHide&&this._doHide(),this.trigger("pop:hide:before"),setTimeout($.proxy(function(){this.nBg.css({opacity:0,"transition-property":"opacity"}),this.trigger("pop:hide:after"),setTimeout($.proxy(function(){this.nBg.hide(),this.nPopContainer.hide(),i||this.destroy()},this),200)},this),this.animationTime),this.onHide()},destroy:function(){return this.nPopContainer.remove(),this.nBg.remove(),this.contentView&&this.contentView.remove(),this}})}),define("bower_components/pop/pop_forbid_scroll",["require","./pop"],function(t){return window.zenjs=window.zenjs||{},t("./pop").extend({init:function(t){this._super(t),t.doNotForbidScroll||(this.on("pop:show:before",$.proxy(this.onBeforePopShow,this)),this.on("pop:show:after",$.proxy(this.onAfterPopShow,this)),this.on("pop:hide:after",$.proxy(this.onAfterPopHide,this)))},onBeforePopShow:function(){this.top=this._window.scrollTop()},onAfterPopShow:function(){this._window.scrollTop(0),this.startShow()},onAfterPopHide:function(){var t,i=function(o){if(t!==this._window.scrollTop()&&o>0)return this._window.scrollTop(t),void setTimeout($.proxy(i,this,o-1));setTimeout($.proxy(this.onFinishHide,this),50)};return function(){this.startHide(),t=this.top,this._window.scrollTop(t),$.proxy(i,this)(2),setTimeout($.proxy(function(){window.zenjs.popList.length<1&&$("html").css("position",this.htmlPosition)},this),200)}}(),startShow:function(){var t=window.zenjs.popList;if(t||(t=window.zenjs.popList=[]),0===t.length){var i=$("body"),o=$("html");this.htmlPosition=o.css("position"),o.css("position","relative"),this.bodyCss=(i.prop("style")||{}).cssText,this.htmlCss=(o.prop("style")||{}).cssText,$("body,html").css({overflow:"hidden",height:this._window.height(),"padding-bottom":0,"margin-bottom":0})}t.indexOf(this)<0&&t.push(this)},startHide:function(){var t=window.zenjs.popList,i=t.indexOf(this);i>-1&&t.splice(i,1),t.length<1&&($("html").attr("style",this.htmlCss||""),$("body").attr("style",this.bodyCss||""))}})}),define("bower_components/pop/popup",["require","./pop_forbid_scroll"],function(t){return t("./pop_forbid_scroll").extend({init:function(t){this._super(t),this.onClickBg=t.onClickBg||function(){},this.onBeforePopupShow=t.onBeforePopupShow||function(){},this.onAfterPopupHide=t.onAfterPopupHide||function(){},this.nPopContainer.css($.extend({left:0,right:0,bottom:0,background:"white"},t.containerCss||{})),this.nPopContainer.css("opacity","0"),this.nPopContainer.on("focus","input, textarea",function(t){var i=$(this),o=$(window),n=o.scrollTop(),s=i.offset().top;(s-n<0||s-n>100)&&setTimeout(function(){var t=s-70;o.scrollTop(t)},400)})},_doShow:function(){this.nPopContainer.addClass("popup"),this.contentView&&this.contentView.height?this.height=this.contentView.height():this.contentView||(this.height=this.nPopContainer.height()),this.onBeforePopupShow(),$(".js-close").click($.proxy(function(t){this.hide()},this)),this.nPopContainer.css({height:this.height+"px",transform:"translate3d(0,100%,0)","-webkit-transform":"translate3d(0,100%,0)"}),this.bodyPadding=$("body").css("padding"),$("body").css("padding","0px"),setTimeout($.proxy(function(){this.nPopContainer.css({transform:"translate3d(0,0,0)","-webkit-transform":"translate3d(0,0,0)","-webkit-transition":"all ease "+this.animationTime+"ms",transition:"all ease "+this.animationTime+"ms",opacity:1})},this)),setTimeout($.proxy(function(){this.contentView&&this.contentView.onAfterPopupShow&&this.contentView.onAfterPopupShow()},this),this.animationTime)},_doHide:function(t){this.nPopContainer.css({transform:"translate3d(0,100%,0)","-webkit-transform":"translate3d(0,100%,0)",opacity:0}),setTimeout($.proxy(function(){$("body").css("padding",this.bodyPadding),this.onAfterPopupHide()},this),this.animationTime)}})}),define("wap/showcase/modules/goods_list/compute_height",[],function(){"use strict";return function(t){function i(t,i){t.find(".js-goods-card .photo-block").each(function(t,n){if(0===i||2===i&&t%3==0){var s=$(n),e=o(s);e=e>500?500:e,+e>0&&s.height(e)}})}function o(t){var i=t.width(),o=t.data("width");return o=o<i?i:o,t.data("height")*(i/o)}function n(t,i){if(3!==t&&"waterfall"!==i){return 0===t&&a>500?245:a>500?176:143}}function s(t,i){var n=0;r=r||t[0].width();for(var s=t.length-1;s>=0;s--){var e=o(t[s]);if((n=Math.max(n,e))>i||0===e){n=i;break}}if(n!=i)for(var s=t.length-1;s>=0;s--)t[s].height(n).css("padding-top",0)}function e(t,i){var o=[],n=[];return 1==i&&t.find(".js-goods-card .photo-block").each(function(t,i){n.push($(i)),a<500&&t%2!=1||a>500&&t%3!=2||(o.push(n),n=[])}),2==i&&a<500&&t.find(".js-goods-card .photo-block").each(function(t,i){t%3!=0&&(n.push($(i)),t%3!=1&&(o.push(n),n=[]))}),0===i&&a>500&&t.find(".js-goods-card .photo-block").each(function(t,i){n.push($(i)),t%2==1&&(o.push(n),n=[])}),n.length>0&&o.push(n),n=[],o}var a,r;t.each(function(t,o){var r=$(o),d=+r.data("size"),h=r.data("showtype");a=a||r.width(),0==r.find("li").length&&r.addClass("hide");var l=n(d,h);if(!l)return r.css("visibility","visible"),void r.prev(".js-goods-list-loading").remove();for(var c=e(r,d),p=0,u=c.length;p<u;p++)s(c[p],l);0!==d&&2!==d||i(r,d),r.css("visibility","visible"),r.prev(".js-goods-list-loading").remove()}),$(window).trigger("scroll")}}),define("wap/showcase/modules/goods_list/show_wish_btn",[],function(){"use strict";return function(t){var i=[],o={};t.each(function(t,n){$(n).find(".js-goods-wish").each(function(t,n){var s=$(n),e=s.parent().find(".goods-wish"),a=s.data("id");i.push(a),o[a]=o[a]||[],o[a].push({nWish:e,nWishResponse:s})})}),0!=i.length&&$._ajax({url:"/v2/trade/wish/isAdded.json?kdt_id="+window._global.kdt_id||0,type:"POST",dataType:"json",data:{goods_ids:i},success:function(t){var i=t.data||{};0==+t.code&&$.each(o,function(t,o){i[t]&&i[t].isWishOpen&&$.each(o,function(o,n){var s=n.nWish,e=n.nWishResponse;s.removeClass("hide"),e.removeClass("hide"),i[t].isWishAdded&&(e.removeClass("js-goods-wish").addClass("js-remove-goods-wish"),s.addClass("added-wish"))})})}})}}),define("wap/components/goods_lists_activity/activity",["require"],function(t){return function(t){var i=window.$,o=i.Deferred();i._ajax({type:"GET",timeout:5e3,url:"/v2/ump/activityInfo/activity.json",data:t}).done(function(i){if(0!=+i.code)return void motify.log("data.msg");for(var n=i.data,s=["降价拍","团购返现","周期购"],e=!1,a=0;a<s.length;a++)if(n.indexOf(s[a])!==-1){e=!0;break}e?(window.location.href=window._global.wap_url.wap+"/goods/"+t.goods_alias,o.reject()):o.resolve()}).fail(function(){motify.log("加载错误，请重试或者刷新页面"),o.reject()});return o}}),require(["zenjs/util/args","wap/showcase/modules/goods_list/box_stream","bower_components/pop/popup","wap/showcase/modules/goods_list/compute_height","wap/showcase/modules/goods_list/show_wish_btn","wap/components/goods_lists_activity/activity","vendor/zepto/outer"],function(t,i,o,n,s,e){!function(t){var o=t(".sc-goods-list.waterfall");o.length&&o.each(function(o,n){var s,e,a,r=t(this),d=2;s=r.outerWidth(),a=Math.floor(s/2)-5,s>=540?(d=3,e=[176.5,176.5,176.5]):e=s>=360?[a,a]:[155,155];var h=new i({container:r[0],rowCount:d,rowContainerClassName:"",rowContainerTagType:"li",rowCintainerWidths:e});h.setListData(),h.sortOut()})}($),function(t){var o=t(".sc-goods-list.size-0"),n=o.find(".js-goods-card.has-sub-title");0!==o.length&&0!==n.length&&(o.outerWidth()<540||o.each(function(o,n){var s=t(this),e=new i({container:s[0],rowCount:2,rowContainerClassName:"",rowContainerTagType:"div",rowCintainerWidths:[265,265]});e.setListData(),e.sortOut()}))}($),function(i){var n=!1,s=function(s,e){var a=i(s.target);if(s.preventDefault(),s.stopPropagation(),"true"!=t.get("hide_buy_btn",location.href)){if(e=e||{},!window._global.is_mobile)return void motify.log("预览不支持进行购买，<br/>实际效果请在手机上进行。");if(n)motify.log("请勿重复提交。");else{var r=a.data("alias"),d=a.data("postage"),h=a.data("buyway"),l=a.data("id"),c=a.data("title"),p=a.data("price"),u=a.parents(".js-goods"),f=a.parents(".link").find(".photo-block img").data("src"),w=a.data("isvirtual");if("0"==h){var g=u.attr("href");window.location.href=g}else{e.isAddWish||a.parent().find(".goods-buy").addClass("ajax-loading"),n=!0;var m=i._ajax({type:"get",timeout:5e3,url:"/v2/showcase/sku/skudata.json",data:{alias:r},dataType:"json",cache:!1,success:function(t){if(0!=+t.code)return void motify.log(t.msg);var n=t.data,s=(n.list[0],n.stock_num),h=l;if(35==n.goods_type)return void(window.location.href=window._global.wap_url.wap+"/goods/"+r);if(s){var u=new Date,g=new Date(1e3*n.start_sold_time),m=(g-u)/1e3;if(n.start_sold_time&&m>0){var v=parseInt(m/3600,10),_=parseInt((m-3600*v)/60,10),y=parseInt(m-3600*v-60*_,10),C=y+"秒";return 0===_&&0===v||(C=_+"分"+C),0!==v&&(C=v+"时"+C),void motify.log("距开售 还剩"+C)}var b=i.extend(!0,{sku:n,goods_id:h,postage:d,goods_info:{title:c,picture:[f],price:p,origin:""},activity_alias:window._global.activity_alias,activity_id:window._global.activity_id,activity_type:window._global.activity_type,isMultiBtn:!0,is_virtual:w},e);new o({contentViewClass:BuyView,className:"sku-layout sku-box-shadow",onFinishHide:function(){e.isAddWish},contentViewOptions:{skuViewConfig:{top:50},need_ajax_login:window._global.need_ajax_login,isCartBtnHide:(n.option||{}).hideCart||window._global.hide_shopping_cart,logURL:window._global.logURL,baseUrl:window._global.wap_url.wap,wxpay_env:window._global.wxpay_env,onAddSuccess:function(t,i){t=t||{},t.wish&&(a.removeClass("js-goods-wish").addClass("js-remove-goods-wish"),a.data("sku",(i||{}).sku_id),a.parent().find(".goods-wish").addClass("added-wish"))}},transparent:".8",isCanNotHide:!1}).render(b).show()}else motify.log("该商品已售罄!")},error:function(t,i,o){"timeout"===i?(m.abort(),motify.log("连接超时")):"error"===i&&(m.abort(),motify.log("请求失败，请刷新或重新打开本页!"))},complete:function(){n=!1,a.parent().find(".goods-buy").removeClass("ajax-loading")}})}}}};i("body").on("click",".js-goods-buy",function(t){var o=i(t.target),n=o.parent().find(".goods-buy");n.addClass("ajax-loading"),t.preventDefault(),t.stopPropagation();var a={goods_id:o.data("id"),kdt_id:window._global.kdt_id,goods_alias:o.data("alias")};e(a).then(function(){s(t)},function(){n.removeClass("ajax-loading")})}),i("body").on("click",".js-goods-wish",function(t){t.preventDefault(),t.stopPropagation(),s(t,{isAddWish:!0,isAddCart:!1,isMultiBtn:!1})}),i("body").on("click",".js-remove-goods-wish",function(t){t.preventDefault(),t.stopPropagation();var o=i(t.target),n=o.data("id"),s=window._global.kdt_id||0;i._ajax({url:"/v2/trade/wish/list.json?kdt_id="+s,type:"DELETE",dataType:"json",cache:!1,timeout:5e3,data:{goods_id:n},success:function(t){0==+t.code?(motify.log("心愿删除成功"),o.addClass("js-goods-wish").removeClass("js-remove-goods-wish"),o.parent().find(".goods-wish").removeClass("added-wish")):motify.log(t.msg)},error:function(t,i,o){motify.log("心愿删除失败。。")}})})}($);var a=$(".js-goods-list");0!=a.length&&(s(a),n(a))}),define("main",function(){});