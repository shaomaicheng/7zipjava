define("zenjs/util/event",["require","jquery"],function(t){var e=t("jquery"),i={getTargetByDataKey:function(t,i){for(var o=e(t.target);!o.data(i)&&0!==o.data(i)&&"BODY"!=(o[0]||{}).nodeName;)o=o.parent();return o},getEventHandler:function(){var t=function(){};return e.extend(!0,t.prototype,i.methods),new t},methods:{events:{},on:function(t,e){return"string"==typeof t&&"[object Function]"===Object.prototype.toString.call(e)&&(this.events[t]||(this.events[t]=[]),this.events[t].push(e))},trigger:function(t){if("string"!=typeof t)return!1;if(!this.events[t])return this.events[t]=[],!1;for(var e=this.events[t],i=Array.prototype.slice.apply(arguments,[1]),o=0,s=e.length;o<s;o++)e[o](i)},off:function(t,e){if(!t&&!e)return void(this.events={});if(!e)return void(this.events[t]=[]);var i=this.events[t],o=i.indexOf(e);i.splice(o,1)}}};return i}),define("zenjs/backbone/tabber",["require","../util/event","backbone"],function(t){var e=t("../util/event"),i=t("backbone"),o=function(){};return i.View.extend({initialize:function(t){this.activeKey=t.activeKey||"type",this.activeClass=t.activeClass||"active",this.hashAsDefaultData=!!t.hashAsDefaultData,this.cbOnClicked=t.onClicked||o,this.cbOnDisabledClicked=t.onDisabledClicked||o,this.initDefault(t)},events:{click:"onClicked"},initDefault:function(t){var e=i.history.getHash();t.hashAsDefaultData&&e?this.active(e):t.defaultData&&t.defaultData.length>0&&this.active(t.defaultData)},onClicked:function(t){if(t.target&&0!==t.target.length){var i=e.getTargetByDataKey(t,this.activeKey),o=""+i.data(this.activeKey);if(void 0===this.firstClick?this.firstClick=!0:this.firstClick=!1,i.blur(),o&&"undefined"!==o&&this.activeData!==o&&o&&o.length>0){if(this.disabled===!0)return void(this.activeData!==o&&this.cbOnDisabledClicked());if(this.hashAsDefaultData){var s=location.href.replace(/(javascript:|#).*$/,"");location.replace(s+"#"+o)}this.$("."+this.activeClass).removeClass(this.activeClass),i.addClass(this.activeClass),this.activeData=o,this.cbOnClicked(_.extend(t||{},{value:o,nTarget:i}))}}},active:function(t,e){this.onClicked(_.extend({target:this.$el.find("[data-"+this.activeKey+'="'+t+'"]:first')},e||{}))},setDisable:function(t){this.disabled=t},setData:function(t){this.activeData=t,this.$("."+this.activeClass).removeClass(this.activeClass),this.$el.find("[data-"+this.activeKey+'="'+this.activeData+'"]:first').addClass(this.activeClass)},getData:function(){return this.activeData}})}),define("wap/components/app_h5/main",["require","exports","module"],function(t,e,i){i.exports={currentUrl:"",currentTime:Date.now(),doCall:function(t,e){window.onReady("YouzanJSBridge",function(){window.YouzanJSBridge.doCall(t,e)})},compareVersion:function(t,e){for(t=t.split(".").join(""),e=e.split(".").join("");t.length!==e.length;)t.length>e.length?e+="0":t+="0";return t=Number(t),e=Number(e),t>e?"gt":t===e?"eq":"lt"},eq:function(t,e){return"eq"===this.compareVersion(t,e)},gte:function(t,e){var i=this.compareVersion(t,e);return"eq"===i||"gt"===i},lte:function(t,e){var i=this.compareVersion(t,e);return"eq"===i||"lt"===i},configNative:function(t){this.doCall("configNative",t)},getData:function(t,e){e.datatype=t,this.doCall("getData",e)},putData:function(t,e){if("youzanwxd"===_global.platform)if(this.gte(_global.platform_version,"1.5.0"))e.datatype=t,this.doCall("putData",e);else switch(t){case"supplierInfo":this.doCall("tellSupplierInfo",{supplier_kdt_id:e.supplier_kdt_id});break;case"goodsInfo":this.doCall("tellGoodsInfo",{goods_id:e.goods_id})}else e.datatype=t,this.doCall("putData",e)},gotoWebview:function(t){if(this.currentUrl===t.url&&Date.now()-this.currentTime<100)this.currentTime=Date.now();else if(this.currentUrl=t.url,this.currentTime=Date.now(),"youzanwxd"===_global.platform)if(this.gte(_global.platform_version,"1.5.0"))this.doCall("gotoWebview",t);else switch(t.page){case"supplierHomepage":this.doCall("goHomePage",{homeurl:t.url,name:t.name});break;case"goodsList":this.doCall("viewGoodsList",{url:t.url});break;case"goodsDetail":this.doCall("viewGoodsDetail",{detail_url:t.url,average_profit:t.average_profit,alias:t.alias,seller_goods_alias:t.seller_goods_alias});break;case"newsDetail":this.doCall("viewNewsDetail",{detail_url:t.url})}else this.doCall("gotoWebview",t)},gotoNative:function(t){if("youzanwxd"===_global.platform)if(this.gte(_global.platform_version,"1.5.0"))this.doCall("gotoNative",t);else switch(t.page){case"addGoods":this.doCall("addGoodsToShop",{alias:t.alias,seller_goods_alias:t.seller_goods_alias})}else this.doCall("gotoNative",t)},doAction:function(t){if("youzanwxd"===_global.platform)if(this.gte(_global.platform_version,"1.5.0"))this.doCall("doAction",t);else switch(t.action){case"back":this.doCall("gotoLogin",{});break;case"appWXPay":this.doCall("appWXPay",{kdt_id:t.kdt_id,order_no:t.order_no});break;case"deliverGoods":this.doCall("deliverGoods",{order_number:t.order_number})}else if("youzanwsc"===_global.platform)if(this.gte(_global.platform_version,"2.8.5"))this.doCall("doAction",t);else switch(t.action){case"back":this.doCall("previousStep",{})}},onAddGoodsSuccess:function(t){window.onReady("YouzanJSBridge",function(){window.YouzanJSBridge.on("addGoodsSuccess",function(e){t(e)})})},on:function(t,e){window.onReady("YouzanJSBridge",function(){window.YouzanJSBridge.on("dataReady",function(i){var o=i.datatype,s=i.data,a={};if("object"==typeof s)a=s;else try{a=JSON.parse(s)}catch(t){}o===t&&e(a)})})}}}),define("bower_components/waterfall/pager",["require","zenjs/events"],function(t){var e=t("zenjs/events"),i=function(){};return e.extend({init:function(t){this.$el||(this.$el=$(t.el||t.$el||"<div></div>"),this.el=this.$el[0]),this.nLoading=t.loadingHTML?$(t.loadingHTML).addClass("loading-more"):$('<div class="loading-more"><span></span></div>'),this.nList=this.$el.find(".js-list"),0===this.nList.length&&(this.nList=$('<div class="js-list b-list"></div>'),this.$el.append(this.nList)),"number"==typeof t.total&&(this.total=t.total),this.offset=t.offset||300,this.scrollDirection="down",this.pageIndex=t.pageIndex||0,this.perPage=t.perPage||10,this.postData=t.postData||{},this.checkSize=!0,"boolean"==typeof t.checkSize&&(this.checkSize=t.checkSize),this.idName=t.idName||"id",t.idValue&&(this.idValue=t.idValue),this.jsonKeys=t.jsonKeys||{},this.finishedHTML=t.finishedHTML,this.finishedText=t.finishedText,this.emptyHTML=t.emptyHTML||"",this.emptyText=t.emptyText||"",this.getExtrPostData=t.getExtrPostData||i,this.onFetchError=t.onFetchError||i,this.onListEmpty=this.onListEmpty||t.onEmpty||this._onListEmpty,this.on("finished",t.onFinished||i),this.on("after:list:load",t.onAfterListLoad||t.onDataLoad||i),this.extraData={},this.scrollContainer=t.scrollContainer?$(t.scrollContainer):$("body"),this.scrollEventAccepter=t.scrollEventAccepter?$(t.scrollEventAccepter):$(t.scrollContainer||window),this._onScroll=$.proxy(this.onScroll,this),this.bindScrollFunc()},$:function(t){return this.$el.find(t)},onScroll:function(){function t(){var t=this.nList.offset(),e=this.scrollContainer.offset();return{left:t.left-e.left||0,top:t.top-e.top||0}}return function(){if(!(this.sleeping||this.finished||this.fetching)){if(0===this.total||this.total&&this.total<=this.pageIndex*this.perPage)return void this.doFinishLoading();var e=t.call(this);"down"===this.scrollDirection&&this.nList.height()+e.top-this.scrollEventAccepter.height()-this.scrollContainer.scrollTop()<this.offset&&this.fetchMore&&this.fetchMore(),"up"===this.scrollDirection&&this.scrollContainer.scrollTop()<this.offset&&this.fetchMore&&this.fetchMore()}}}(),fetchMore:function(){return this.sleeping||this.finished||this.fetching?this:(this.showLoading(),this.fetching=!0,this._fetchMore&&this._fetchMore.call(this),this)},onFetchMoreSuccess:function(){this.hideLoading(),this.fetching=!1,this._onFetchMoreSuccess.apply(this,arguments)},fetchRender:function(){return this.fetchMore(),this},_onFetchMoreError:function(){this.fetching=!1,this.hideLoading(),this.onFetchError()},doFinishLoading:function(t){this.finished=!0,this.fetching=!1,this.hideLoading(),this.$el.find(".list-finished").remove(),this.triggerMethod&&this.triggerMethod("finished",this.collection,t)},bindScrollFunc:function(){var t=this;this.scrollFunc&&this.unbindScrollFunc(),this.scrollFunc=function(){t.scrollTimeout&&clearTimeout(t.scrollTimeout),t.scrollTimeout=setTimeout(t._onScroll,200)},this.scrollEventAccepter.on("scroll",this.scrollFunc)},unbindScrollFunc:function(){this.scrollEventAccepter.off("scroll",this.scrollFunc),this.scrollFunc=null},doSleep:function(){this.sleeping=!0,this.unbindScrollFunc()},doWake:function(){this.sleeping=!1,this.bindScrollFunc(),this.fetchMore()},showLoading:function(){this.hasFetching=!0,this.$el.append(this.nLoading)},hideLoading:function(){this.nLoading.remove()},getFinishHtml:function(){return this.finishedHTML?$(this.finishedHTML).addClass("list-finished"):'<div class="list-finished">'+(this.finishedText||"已经没有更多了")+"</div>"},setExtraData:function(t){$.extend(this.extraData,t)},resetWaterfall:function(t){this.finished===!0&&this.$(".list-finished").remove(),this.removeAll&&this.removeAll(),this.nList.empty(),this.collection&&this.collection.reset([],{silent:!0}),this.listEl&&this.listEl.empty(),this.finished=!1,t&&t.pageIndex?this.pageIndex=t.pageIndex:this.pageIndex=0,this.idValue=void 0},_onListEmpty:function(){if(!this.fetching){var t;this.emptyHTML?t=$(this.emptyHTML).addClass("list-finished"):this.emptyText&&(t='<div class="list-finished">'+this.emptyText+"</div>"),this.$el.append(t)}},destroy:function(){this.doSleep(),this.$el.remove(),this.unbindScrollFunc()},remove:function(){this.destroy()}})}),define("bower_components/waterfall/waterfall_html",["require","bower_components/ajax/ajax","jquery","./pager"],function(t){t("bower_components/ajax/ajax");var e=t("jquery"),i=t("./pager");return i.extend({init:function(t){this.$el&&this.$el.find(".list-finished")&&this.$el.find(".list-finished").length>0||(this._super(t),void 0!==t.pageIndex?this.pageIndex=+t.pageIndex:this.pageIndex=1,this.url=t.url||"",this.ajaxType=t.ajaxType||"GET",this.dataType=t.dataType||"json",this.on("finished",this._doFinishLoading),this.onScroll())},_fetchMore:function(){var t=this,i={};this.perPage&&(i[this.jsonKeys.perPage||"perpage"]=this.perPage),this.idValue?i[this.idName]=this.idValue:i[this.jsonKeys.pageIndex||"page"]=this.pageIndex+1;var o=this.getExtrPostData?this.getExtrPostData():{};e._ajax({url:t.url,type:t.ajaxType,dataType:t.dataType,data:e.extend({},t.postData,i,o,t.extraData),timeout:5e3,success:function(e){t.pageIndex++,e&&0==e.code?t.onFetchMoreSuccess({},e||{}):t.doFinishLoading(e)},error:function(e,i,o){t._onFetchMoreError()}})},_onFetchMoreSuccess:function(t,e){var i=(e||{}).data||{};if(i[this.idName]&&(this.idValue=i[this.idName]),this.triggerMethod("after:list:load",i.html||"",e),!i.html)return this.pageIndex--,void this.doFinishLoading(e);this.onScroll()},_doFinishLoading:function(){if(0==this.pageIndex&&this.triggerMethod("list:empty"),this.hasFetching&&this.pageIndex>2){var t=this.getFinishHtml();this.$el.append(t)}}})}),define("wap/fenxiao/components/log",[],function(){var t=function(){};return{displayLog:function(e,i){i=i||t;var o={fm:"display",display_goods:e.display_goods,spm:"wxdatv-"+e.activity_id,target:"wxd",seller_kdt_id:e.seller_kdt_id,title:e.title||document.title,result_from:e.result_from||"",result_number:e.result_number||""};window.Logger&&window.Logger.log(o).done(i)},beforeAddLog:function(e,i){i=i||t;var o={fm:"click",click_type:"wxd_before_add",seller_kdt_id:e.seller_kdt_id,display_goods:e.display_goods,spm:"wxdatv-"+e.activity_id,target:"wxd",title:e.title||document.title,result_from:e.result_from||"",result_number:e.result_number||""};window.Logger&&window.Logger.log(o).done(i)},gotoDetailLog:function(e,i){i=i||t;var o={fm:"display",display_goods:e.display_goods,spm:"wxdatv-"+e.activity_id+"_wxdg"+e.kdt_goods_id,target:"wxd",seller_kdt_id:e.seller_kdt_id,title:e.title||document.title,result_from:e.result_from||"",result_number:e.result_number||""};window.Logger&&window.Logger.log(o).done(i)},addGoodsSuccessLog:function(e,i){i=i||t;var o={fm:"click",click_type:"wxd_add",seller_kdt_id:e.seller_kdt_id,display_goods:e.display_goods,spm:"wxdatv-"+e.activity_id,target:"wxd",title:e.title||document.title,result_from:e.result_from||"",result_number:e.result_number||""};window.Logger&&window.Logger.log(o).done(i)}}}),require(["zenjs/backbone/tabber","zenjs/util/args","wap/components/app_h5/main","bower_components/waterfall/waterfall_html","wap/fenxiao/components/log"],function(t,e,i,o,s){var a,n=_global.access_token||e.get("access_token"),l=_global.config.supplier_kdt_id,d=$("#goods-list"),r=window._global.wxdData||{},c=_global.config.current_activity_id,h=_global.kdt_id,g=[];window.tabber=new t({el:$(".js-tabber"),defaultData:"desc",onClicked:function(t){var e=t.value;$(".js-content-region").hide(),$(".js-"+e+"-region").show(),"home"!==e||a||(a=new o({el:d,perPage:r.perpage||10,total:r.total,onDataLoad:function(t){d.find(".js-list").append(t),$(".js-lazy").lazyload();for(var e=[],i=$(t),o=0;o<i.length;o++)1===i[o].nodeType&&e.push($(i[o]).data("kdt_goods_id"));s.displayLog({display_goods:e.join(","),activity_id:c,seller_kdt_id:h,title:_global.config.title})},url:"/v2/fenxiao/activity/goodsList.json",postData:{access_token:n,activity_id:c,template_id:_global.config.template_id},finishedText:"没有更多商品了"}).fetchRender())}}),$(".js-follow").on("click",function(t){var e=$(t.target);$._ajax({url:"/v2/fenxiao/supplier/follow.json",type:"POST",data:{supplier_kdt_id:l,access_token:n},success:function(t){0===t.code?(motify.log("关注成功"),e.html("已关注"),e.removeClass("js-follow")):motify.log(t.msg)},error:function(){motify.log("网络错误")}})}),$(".js-goto-homepage").on("click",function(){i.gotoWebview({page:"supplierHomepage",url:_global.url.wap+"/fenxiao/supplier/index?supplier_kdt_id="+l})}),$(".js-take").on("click",function(){window.tabber.active("home")}),d.on("click",".js-opt",function(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();var e=$(t.target).parents(".js-goto-detail"),o=e.data();return $(t.target).hasClass("added")&&o.seller_goods_alias?(i.gotoNative({alias:o.alias,seller_goods_alias:o.seller_goods_alias||g[o.alias]||"",page:"addGoods"}),!1):!$(t.target).hasClass("added")&&($._ajax({url:"/v2/fenxiao/goods/create.json?access_token="+n,type:"POST",data:{origin_goods_id:o.kdt_goods_id,origin_kdt_id:o.kdt_id,access_token:n},success:function(t){if(0===t.code){motify.log("上架成功");var e=$('.js-goto-detail[data-alias="'+o.alias+'"]');e.find(".js-opt").removeClass("add").addClass("added"),s.addGoodsSuccessLog({seller_kdt_id:h,display_goods:e.data("kdt_goods_id"),activity_id:c,title:_global.config.title})}else motify.log(t.msg)},error:function(){motify.log("网络错误")}}),void s.beforeAddLog({seller_kdt_id:h,display_goods:o.kdt_goods_id,activity_id:c,title:_global.config.title}))}).on("click",".js-goto-detail",function(t){var e;e=$(t.target).hasClass(".js-goto-detail")?$(t.target):$(t.target).parents(".js-goto-detail");var o=e.data();s.gotoDetailLog({display_goods:o.kdt_goods_id,activity_id:c,kdt_goods_id:o.kdt_goods_id,seller_kdt_id:h,title:_global.config.title},function(){i.gotoWebview({page:"goodsDetail",alias:o.alias,seller_goods_alias:o.seller_goods_alias||g[o.alias]||"",average_profit:o.average_profit,url:_global.url.wap+"/showcase_fenxiao/goods?alias="+o.alias+"&kdtfrom=wxd"})})});for(var f=_global.goodsList,u=[],p=0;p<f.length;p++)u.push(f[p].kdt_goods_id);s.displayLog({display_goods:u.join(","),activity_id:c,seller_kdt_id:h,title:_global.config.title})}),define("main",function(){});