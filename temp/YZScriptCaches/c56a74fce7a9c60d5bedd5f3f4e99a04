define("bower_components/waterfall/pager",["require","zenjs/events"],function(i){var t=i("zenjs/events"),e=function(){};return t.extend({init:function(i){this.$el||(this.$el=$(i.el||i.$el||"<div></div>"),this.el=this.$el[0]),this.nLoading=i.loadingHTML?$(i.loadingHTML).addClass("loading-more"):$('<div class="loading-more"><span></span></div>'),this.nList=this.$el.find(".js-list"),0===this.nList.length&&(this.nList=$('<div class="js-list b-list"></div>'),this.$el.append(this.nList)),"number"==typeof i.total&&(this.total=i.total),this.offset=i.offset||300,this.scrollDirection="down",this.pageIndex=i.pageIndex||0,this.perPage=i.perPage||10,this.postData=i.postData||{},this.checkSize=!0,"boolean"==typeof i.checkSize&&(this.checkSize=i.checkSize),this.idName=i.idName||"id",i.idValue&&(this.idValue=i.idValue),this.jsonKeys=i.jsonKeys||{},this.finishedHTML=i.finishedHTML,this.finishedText=i.finishedText,this.emptyHTML=i.emptyHTML||"",this.emptyText=i.emptyText||"",this.getExtrPostData=i.getExtrPostData||e,this.onFetchError=i.onFetchError||e,this.onListEmpty=this.onListEmpty||i.onEmpty||this._onListEmpty,this.on("finished",i.onFinished||e),this.on("after:list:load",i.onAfterListLoad||i.onDataLoad||e),this.extraData={},this.scrollContainer=i.scrollContainer?$(i.scrollContainer):$("body"),this.scrollEventAccepter=i.scrollEventAccepter?$(i.scrollEventAccepter):$(i.scrollContainer||window),this._onScroll=$.proxy(this.onScroll,this),this.bindScrollFunc()},$:function(i){return this.$el.find(i)},onScroll:function(){function i(){var i=this.nList.offset(),t=this.scrollContainer.offset();return{left:i.left-t.left||0,top:i.top-t.top||0}}return function(){if(!(this.sleeping||this.finished||this.fetching)){if(0===this.total||this.total&&this.total<=this.pageIndex*this.perPage)return void this.doFinishLoading();var t=i.call(this);"down"===this.scrollDirection&&this.nList.height()+t.top-this.scrollEventAccepter.height()-this.scrollContainer.scrollTop()<this.offset&&this.fetchMore&&this.fetchMore(),"up"===this.scrollDirection&&this.scrollContainer.scrollTop()<this.offset&&this.fetchMore&&this.fetchMore()}}}(),fetchMore:function(){return this.sleeping||this.finished||this.fetching?this:(this.showLoading(),this.fetching=!0,this._fetchMore&&this._fetchMore.call(this),this)},onFetchMoreSuccess:function(){this.hideLoading(),this.fetching=!1,this._onFetchMoreSuccess.apply(this,arguments)},fetchRender:function(){return this.fetchMore(),this},_onFetchMoreError:function(){this.fetching=!1,this.hideLoading(),this.onFetchError()},doFinishLoading:function(i){this.finished=!0,this.fetching=!1,this.hideLoading(),this.$el.find(".list-finished").remove(),this.triggerMethod&&this.triggerMethod("finished",this.collection,i)},bindScrollFunc:function(){var i=this;this.scrollFunc&&this.unbindScrollFunc(),this.scrollFunc=function(){i.scrollTimeout&&clearTimeout(i.scrollTimeout),i.scrollTimeout=setTimeout(i._onScroll,200)},this.scrollEventAccepter.on("scroll",this.scrollFunc)},unbindScrollFunc:function(){this.scrollEventAccepter.off("scroll",this.scrollFunc),this.scrollFunc=null},doSleep:function(){this.sleeping=!0,this.unbindScrollFunc()},doWake:function(){this.sleeping=!1,this.bindScrollFunc(),this.fetchMore()},showLoading:function(){this.hasFetching=!0,this.$el.append(this.nLoading)},hideLoading:function(){this.nLoading.remove()},getFinishHtml:function(){return this.finishedHTML?$(this.finishedHTML).addClass("list-finished"):'<div class="list-finished">'+(this.finishedText||"已经没有更多了")+"</div>"},setExtraData:function(i){$.extend(this.extraData,i)},resetWaterfall:function(i){this.finished===!0&&this.$(".list-finished").remove(),this.removeAll&&this.removeAll(),this.nList.empty(),this.collection&&this.collection.reset([],{silent:!0}),this.listEl&&this.listEl.empty(),this.finished=!1,i&&i.pageIndex?this.pageIndex=i.pageIndex:this.pageIndex=0,this.idValue=void 0},_onListEmpty:function(){if(!this.fetching){var i;this.emptyHTML?i=$(this.emptyHTML).addClass("list-finished"):this.emptyText&&(i='<div class="list-finished">'+this.emptyText+"</div>"),this.$el.append(i)}},destroy:function(){this.doSleep(),this.$el.remove(),this.unbindScrollFunc()},remove:function(){this.destroy()}})}),define("bower_components/waterfall/waterfall_html",["require","bower_components/ajax/ajax","jquery","./pager"],function(i){i("bower_components/ajax/ajax");var t=i("jquery"),e=i("./pager");return e.extend({init:function(i){this.$el&&this.$el.find(".list-finished")&&this.$el.find(".list-finished").length>0||(this._super(i),void 0!==i.pageIndex?this.pageIndex=+i.pageIndex:this.pageIndex=1,this.url=i.url||"",this.ajaxType=i.ajaxType||"GET",this.dataType=i.dataType||"json",this.on("finished",this._doFinishLoading),this.onScroll())},_fetchMore:function(){var i=this,e={};this.perPage&&(e[this.jsonKeys.perPage||"perpage"]=this.perPage),this.idValue?e[this.idName]=this.idValue:e[this.jsonKeys.pageIndex||"page"]=this.pageIndex+1;var s=this.getExtrPostData?this.getExtrPostData():{};t._ajax({url:i.url,type:i.ajaxType,dataType:i.dataType,data:t.extend({},i.postData,e,s,i.extraData),timeout:5e3,success:function(t){i.pageIndex++,t&&0==t.code?i.onFetchMoreSuccess({},t||{}):i.doFinishLoading(t)},error:function(t,e,s){i._onFetchMoreError()}})},_onFetchMoreSuccess:function(i,t){var e=(t||{}).data||{};if(e[this.idName]&&(this.idValue=e[this.idName]),this.triggerMethod("after:list:load",e.html||"",t),!e.html)return this.pageIndex--,void this.doFinishLoading(t);this.onScroll()},_doFinishLoading:function(){if(0==this.pageIndex&&this.triggerMethod("list:empty"),this.hasFetching&&this.pageIndex>2){var i=this.getFinishHtml();this.$el.append(i)}}})}),define("text!wap/trade/wish/share_finished/template/emptyList.html",[],function(){return'<div class="empty-list wish-empty-list finished-empty-list">\n\t<% if(data.myself){ %>\n\t\t<div class="empty-list-header">\n\t\t    <h4>为你买单的TA还没来哟～<br/>亲朋好友闺蜜兄弟一起召唤</h4>\n\t\t</div>\n\t\t<div class="empty-list-content"><a href="javascript:;" class="tag-wish tag tag-big tag-orange js-open-share">召唤TA来买单</a></div>\n\t<% } else { %>\n\t\t<div class="empty-list-header">\n\t\t    <h4>TA还没有人送哦～<br/>快点挑商品给TA买单吧</h4>\n\t\t</div>\n\t\t<div class="empty-list-content"><a href="<%= data.wish_link %>" class="tag-wish tag tag-big tag-orange">我要帮TA买单</a></div>\n\t<% } %>\n</div>\n'}),define("zenjs/util/number",[],function(){return{makeRandomString:function(i){var t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";i=i||10;for(var s=0;s<i;s++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}}}),define("bower_components/pop/pop",["require","zenjs/events","zenjs/util/number"],function(i){var t=function(){},e=i("zenjs/events"),s=i("zenjs/util/number");return window.zenjs=window.zenjs||{},e.extend({init:function(i){this._window=$(window);var e=s.makeRandomString();$("body").append('<div id="'+e+'"                 style="display:none; height: 100%;                 position: fixed; top: 0; left: 0; right: 0;                background-color: rgba(0, 0, 0, '+(i.transparent||".7")+');z-index:1000;opacity:0;transition: opacity ease 0.2s;"></div>'),this.nBg=$("#"+e),this.nBg.on("click",$.proxy(function(){this.isCanNotHide||this.hide()},this));var n=s.makeRandomString();$("body").append('<div id="'+n+'" class="'+(i.className||"")+'" style="overflow:hidden;visibility: hidden;"></div>'),this.nPopContainer=$("#"+n),this.nPopContainer.hide(),this.nPopContainer.css({opacity:0,position:"absolute","z-index":1e3}),i.contentViewClass&&(this.contentViewClass=i.contentViewClass,this.contentViewOptions=$.extend({el:this.nPopContainer},i.contentViewOptions||{}),this.contentView=new this.contentViewClass($.extend({onHide:$.proxy(this.hide,this)},this.contentViewOptions)),this.contentView.onHide=$.proxy(this.hide,this)),this.animationTime=i.animationTime||300,this.isCanNotHide=i.isCanNotHide,this.doNotRemoveOnHide=i.doNotRemoveOnHide||!1,this.onShow=i.onShow||t,this.onHide=i.onHide||t,this.onFinishHide=i.onFinishHide||t,this.html=i.html},render:function(i){return this.renderOptions=i||{},this.contentViewClass?this.contentView.render(this.renderOptions):this.html&&this.nPopContainer.html(this.html),this},show:function(){return this.nBg.show().css({opacity:"1","transition-property":"none"}),this.nPopContainer.show(),this.trigger("pop:show:before"),setTimeout($.proxy(function(){this.trigger("pop:show:after"),this.nPopContainer.show().css("visibility","visible"),this._doShow&&this._doShow(),this.onShow()},this),200),this},hide:function(i){i=i||{};var t=i.doNotRemove||this.doNotRemoveOnHide||!1;this._doHide&&this._doHide(),this.trigger("pop:hide:before"),setTimeout($.proxy(function(){this.nBg.css({opacity:0,"transition-property":"opacity"}),this.trigger("pop:hide:after"),setTimeout($.proxy(function(){this.nBg.hide(),this.nPopContainer.hide(),t||this.destroy()},this),200)},this),this.animationTime),this.onHide()},destroy:function(){return this.nPopContainer.remove(),this.nBg.remove(),this.contentView&&this.contentView.remove(),this}})}),define("bower_components/pop/pop_forbid_scroll",["require","./pop"],function(i){return window.zenjs=window.zenjs||{},i("./pop").extend({init:function(i){this._super(i),i.doNotForbidScroll||(this.on("pop:show:before",$.proxy(this.onBeforePopShow,this)),this.on("pop:show:after",$.proxy(this.onAfterPopShow,this)),this.on("pop:hide:after",$.proxy(this.onAfterPopHide,this)))},onBeforePopShow:function(){this.top=this._window.scrollTop()},onAfterPopShow:function(){this._window.scrollTop(0),this.startShow()},onAfterPopHide:function(){var i,t=function(e){if(i!==this._window.scrollTop()&&e>0)return this._window.scrollTop(i),void setTimeout($.proxy(t,this,e-1));setTimeout($.proxy(this.onFinishHide,this),50)};return function(){this.startHide(),i=this.top,this._window.scrollTop(i),$.proxy(t,this)(2),setTimeout($.proxy(function(){window.zenjs.popList.length<1&&$("html").css("position",this.htmlPosition)},this),200)}}(),startShow:function(){var i=window.zenjs.popList;if(i||(i=window.zenjs.popList=[]),0===i.length){var t=$("body"),e=$("html");this.htmlPosition=e.css("position"),e.css("position","relative"),this.bodyCss=(t.prop("style")||{}).cssText,this.htmlCss=(e.prop("style")||{}).cssText,$("body,html").css({overflow:"hidden",height:this._window.height(),"padding-bottom":0,"margin-bottom":0})}i.indexOf(this)<0&&i.push(this)},startHide:function(){var i=window.zenjs.popList,t=i.indexOf(this);t>-1&&i.splice(t,1),i.length<1&&($("html").attr("style",this.htmlCss||""),$("body").attr("style",this.bodyCss||""))}})}),define("bower_components/pop/popout",["require","./pop_forbid_scroll"],function(i){return i("./pop_forbid_scroll").extend({init:function(i){i=i||{},this._super(i),this.css=$.extend({transition:"opacity ease "+this.animationTime+"ms",top:"50%",left:"50%","-webkit-transform":"translate3d(-50%, -50%, 0)",transform:"translateY(-50%, -50%, 0)"},i.css||{}),this.nPopContainer.css(this.css)},_doShow:function(){$(".js-popout-close").click($.proxy(function(i){this.hide()},this)),this.nPopContainer.css("opacity",1),this.nPopContainer.show()},_doHide:function(i){this.nPopContainer.css({opacity:0})}})}),define("bower_components/pop/popout_box",["require","./popout"],function(i){var t=function(){};return i("./popout").extend({init:function(i){this._super(i),this._onOKClicked=i.onOKClicked||t,this._onCancelClicked=i.onCancelClicked||t,this.preventHideOnOkClicked=i.preventHideOnOkClicked||!1,this.width=i.width,this.setEventListener()},setEventListener:function(){this.nPopContainer.on("click",".js-ok",$.proxy(this.onOKClicked,this)),this.nPopContainer.on("click",".js-cancel",$.proxy(this.onCancelClicked,this))},_doShow:function(){this.boxCss={"border-radius":"4px",background:"white",width:this.width||"270px",padding:"15px"},this.nPopContainer.css(this.boxCss).addClass("popout-box"),this._super()},_doHide:function(i){this._super()},onOKClicked:function(i){this._onOKClicked(i),!this.preventHideOnOkClicked&&this.hide()},onCancelClicked:function(i){this._onCancelClicked(i),this.hide()}})}),define("text!wap/trade/wish/share/template/wish_guide.html",[],function(){return'<div class="wish-guide-box form-dialog">\n    <div class="header">\n        <h2 class="title center">如何添加自己喜欢的</h2>\n        <span class="close-icon js-cancel"></span>\n    </div>\n    <ol>\n        <li>发现喜欢的商品直接点击<i class="add-wish-1"></i></li>\n        <li>在好友喜欢的商品中点击<i class="add-wish-2"></i>就是你喜欢的啦</li>\n        <% if (!isMyself) { %>\n        <li>一键快速复制好友喜欢的商品</li>\n        <% } %>\n    </ol>\n\n    <div class="action-container">\n\n    <% if (isMyself) { %>\n        <div class="btn-2-1">\n            <a class="btn btn-green btn-block" href="<%= homepage %>">再逛逛</a>\n        </div>\n        <div class="btn-2-1">\n            <button class="btn btn-block btn-white js-cancel">我知道了</button>\n        </div>\n    <% } else { %>\n        <div class="btn-2-1">\n            <a class="btn btn-green btn-block js-copy-wish" href="javascript:;">复制TA喜欢的</a>\n        </div>\n        <div class="btn-2-1">\n            <a class="btn btn-block btn-white" href="<%= homepage %>">我自己选</a>\n        </div>\n    <% } %>\n    </div>\n</div>\n'}),define("text!wap/trade/wish/share/template/vip_wish_guide.html",[],function(){return'<div class="wish-guide-box form-dialog vip-guide">\n    <div class="header">\n        <h2 class="title center">如何添加自己想要的</h2>\n        <span class="close-icon js-cancel"></span>\n    </div>\n    <ol>\n        <li>发现想要的商品直接点击<i class="add-wish-1"></i></li>\n        <li>在好友想要的商品中点击<i class="add-wish-2"></i>就是你想要的啦</li>\n        <% if (!isMyself) { %>\n        <li>一键快速复制好友想要的商品</li>\n        <% } %>\n    </ol>\n\n    <div class="action-container">\n    <% if (isMyself) { %>\n        <div class="btn-2-1">\n            <a class="btn btn-green btn-block" href="<%= homepage %>">再逛逛</a>\n        </div>\n        <div class="btn-2-1">\n            <button class="btn btn-block btn-white js-cancel">我知道了</button>\n        </div>\n    <% } else { %>\n        <div class="btn-2-1">\n            <a class="btn btn-green btn-block js-copy-wish" href="javascript:;">复制TA想要的</a>\n        </div>\n        <div class="btn-2-1">\n            <a class="btn btn-block btn-white" href="<%= homepage %>">我自己选</a>\n        </div>\n    <% } %>\n    </div>\n</div>\n'}),define("wap/trade/wish/share/views/wish_guide",["text!wap/trade/wish/share/template/wish_guide.html","text!wap/trade/wish/share/template/vip_wish_guide.html"],function(i,t){var e=function(){};return Backbone.View.extend({events:{"click .js-copy-wish":"copyWish"},initialize:function(s){this.isMyself=s.isMyself,this.homepage=s.homepage,this.doCopy=s.doCopy||e,this.onCopyWish=s.onCopyWish||e,this.useVipTpl=s.useVipTpl,this.template=_.template(this.useVipTpl?t:i)},render:function(){this.$el.html(this.template({isMyself:this.isMyself,homepage:this.homepage,_global:window._global}))},copyWish:function(){this.onCopyWish(),this.doCopy()}})}),define("text!wap/trade/wish/share/template/add_address_notice.html",[],function(){return'<form class="form-dialog add-address-box">\n    <div class="header">\n        <h2 class="title center">确认收货地址</h2>\n        <span class="close-icon pull-right js-cancel"></span>\n    </div>\n    <fieldset class="field-info">\n        <p class="font-size-14">请确认你的收货地址，TA才能为你买单哦！</p>\n    </fieldset>\n    <div class="action-container">\n        <a href="<%= myWishUrl %>" class="btn btn-green btn-block">我要确认</a>\n    </div>\n</form>\n'}),require(["bower_components/waterfall/waterfall_html","text!wap/trade/wish/share_finished/template/emptyList.html","bower_components/pop/popout_box","wap/trade/wish/share/views/wish_guide","zenjs/util/str","text!wap/trade/wish/share/template/add_address_notice.html"],function(i,t,e,s,n,o){function h(){var i=$(".js-goods-title").not(".ellipsised"),t=i.find("h3");setTimeout(function(){n.multiEllipsis(i,t),i.addClass("ellipsised")})}var a=_.template(t),r=window._global.finished_list||{},l=window._global;if($(".js-my-wish").on("click",function(){var i;if(l.is_vip_wish&&!l.fans_nickname)return i=l.wap_url.wap+"/trade/wish",void(window.location.href=i+"/transfer?kdt_id="+l.kdt_id+"&transfer_url="+encodeURIComponent(r.my_wish_url));window.location.href=r.my_wish_url}),0===parseInt(r.total,10))return $("#wish-list-container").html(a({data:{wish_link:r.wish_link,myself:r.myself}})),this;h(),new i({el:$("#wish-list-container"),perPage:r.perpage||10,total:parseInt(r.total,10),postData:{pars:r.pars},url:"/v2/trade/wish/finished.json",onDataLoad:function(i){$(".js-list").append(i),h()},idValue:(l.finished_list||{}).id||0,finishedHTML:l.is_vip_wish?'<div style="display:none;"></div>':""}).fetchRender(),$(".js-wish-guide-icon").on("click",function(){new e({contentViewClass:s,contentViewOptions:{homepage:"/v2/showcase/homepage?kdt_id="+l.kdt_id}}).render().show()})}),define("main",function(){});