require(["zenjs/events"],function(t){new(t.extend({init:function(t){this.$el=$(t.el),this.el=this.$el[0],this.cardNo="",this.nCardNo=this.$el.find(".js-card-no"),this.nSubmit=this.$el.find(".js-submit"),this.trade_no=window._global.trade_no,this.order_no=window._global.order_no,this.setListening(),this.onCardNoKeyUp()},setListening:function(){this.$el.on("click",".js-submit",$.proxy(this.onSubmit,this)),this.$el.on("input",".js-card-no",$.proxy(this.onCardNoKeyUp,this))},onSubmit:function(){var t=function(){var t=this.nCardNo;motify.log("请填写正确的卡号"),t.addClass("error").one("click",function(n){t.removeClass("error")})};return function(n){var i=this;if(n.preventDefault(),n.stopPropagation(),!this.ajaxing){var e=this.getCardNo();if(e.length<14||e.length>20)return void t.call(this);$._ajax({url:"/v2/pay/yeepay/checkCard.json",type:"POST",dataType:"json",data:{cardId:e,order_no:this.order_no,trade_no:this.trade_no},beforeSend:function(){i.ajaxing=!0,i.nSubmit.attr("disabled","disabled")},success:function(t){var n=t.code,i=t.msg,e=t.data||{};if(0==n)return void(location.href=e.url);motify.log(i)},complete:function(){i.nSubmit.removeAttr("disabled"),i.ajaxing=!1}})}}}(),getCardNo:function(){return this.cardNo=this.nCardNo.val().replace(/[\sa-zA-Z]/g,"")},onCardNoKeyUp:function(t){var n=this.getCardNo(),i=n.replace(/(\d{4})(?=\d)/g,"$1 "),e=this.nCardNo[0];this.nCardNo.val(i),"ios"!=window._global.mobile_system&&e.setSelectionRange&&setTimeout(function(){e.setSelectionRange(i.length,i.length)},0)}}))({el:$("body")})}),define("main",function(){});