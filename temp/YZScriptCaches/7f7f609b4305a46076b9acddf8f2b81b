require(["zenjs/util/args","zenjs/util/cookie"],function(a,i){new(Backbone.View.extend({initialize:function(a){this.wxpay_env=a.global.wxpay_env?1:0,this.buyUrl=a.global.wap_url.wap,this.cardData=((a.global.level||{}).sku||[])[0],this.baseUrl=a.global.wap_url.wap},el:$("body"),events:{"click .js-show-sub-info":"toggleSubInfo","click .js-buy":"buyCard"},toggleSubInfo:function(a){var i=$(a.target),o=i.find(".member-arrow");i.parent().hasClass("show-sub-info")?(i.parent().removeClass("show-sub-info"),o.addClass("member-arrow-right")):(i.parent().addClass("show-sub-info"),o.removeClass("member-arrow-right"))},buyCard:function(o){if(this.ajaxing)return void motify.log("提交订单中，请勿重复提交。");var t=this,e={postage:0,use_wxpay:this.wxpay_env,accept_price:1,order_from:"",kdt_id:window._global.kdt_id||""},n={goods_id:this.cardData.goods_id,num:1,sku_id:this.cardData.goods_sku_id,price:this.cardData.price,dc_ps:i("dc_ps")||""},s=[n];$._ajax({url:"/v2/trade/common/cache.json",type:"POST",dataType:"json",data:{goodsList:JSON.stringify(s),common:JSON.stringify(e)},timeout:15e3,beforeSend:_(function(){this.ajaxing=!0}).bind(this),success:function(i){var o=+i.code,e=i.data;if(0!==o)return void motify.log(i.msg);var n=window._global.url.trade+e.url;n=a.add(n,{showwxpaytitle:1,kdt_id:window._global.kdt_id,wxpay_env:t.wxpay_env}),location.href=a.add(n,{book_key:e.key})},error:_(function(){motify.log("网络堵住啦..."),this.ajaxing=!1}).bind(this),complete:_(function(){this.ajaxing=!1}).bind(this)})}}))({global:window._global})}),define("main",function(){});