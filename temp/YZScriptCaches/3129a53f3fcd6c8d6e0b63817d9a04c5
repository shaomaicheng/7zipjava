define("bower_components/ZanUtil/src/_",[],function(){"use strict";var t={},i={},e=Array.prototype,n=Object.prototype,o=n.toString,s=e.slice,r=e.forEach,a=Object.keys;t.trim=function(t){return null==t?"":String.prototype.trim.call(t)};var c=t.each=t.forEach=function(e,n,o){if(null!=e)if(r&&e.forEach===r)e.forEach(n,o);else if(e.length===+e.length){for(var s=0,a=e.length;s<a;s++)if(n.call(o,e[s],s,e)===i)return}else for(var c=t.keys(e),s=0,a=c.length;s<a;s++)if(n.call(o,e[c[s]],c[s],e)===i)return};return t.keys=a||function(i){if(i!==Object(i))throw new TypeError("Invalid object");var e=[];for(var n in i)t.has(i,n)&&e.push(n);return e},t.has=function(t,i){return null!==t&&Object.hasOwnProperty.call(t,i)},t.extend=function(t){return c(s.call(arguments,1),function(i){if(i)for(var e in i)t[e]=i[e]}),t},c(["Arguments","Function","String","Number","Date","RegExp"],function(i){t["is"+i]=function(t){return o.call(t)=="[object "+i+"]"}}),t}),define("bower_components/ZanUtil/src/args",["require","./_"],function(t){"use strict";var i=t("./_"),e={getParameterByName:function(t,i){t=t.replace(/[[]/,"\\[").replace(/[]]/,"\\]"),i=i?"?"+i.split("#")[0].split("?")[1]:window.location.search;var e=RegExp("[?&]"+t+"=([^&#]*)").exec(i);return e?decodeURIComponent(e[1].replace(/\+/g," ")):""},removeParameter:function(t,i){var e=t.split("?");if(e.length>=2){for(var n=encodeURIComponent(i)+"=",o=e[1].split(/[&;]/g),s=o.length;s-- >0;)o[s].lastIndexOf(n,0)!==-1&&o.splice(s,1);return t=e[0]+"?"+o.join("&")}return t},addParameter:function(){var t=function(t){var e="";for(var n in t)""!==t[n]&&(e+=i.trim(n)+"="+t[n]+"&");return e?"?"+e.slice(0,e.length-1):""};return function(e,n){if(!e||0===e.length||0===i.trim(e).indexOf("javascript"))return"";var o=e.split("#"),s=o[0].split("?"),r={};return s[1]&&i.each(s[1].split("&"),function(t,i){var e;e=t.split("="),r[e[0]]=e.slice(1).join("=")}),i.each(n||{},function(t,e){r[i.trim(e)]=encodeURIComponent(t)}),e=s[0]+t(r),o[1]?e+="#"+o[1]:e}}()};return e.get=e.getParameterByName,e.remove=e.removeParameter,e.add=e.addParameter,e}),define("zenjs/util/number",[],function(){return{makeRandomString:function(t){var i="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t=t||10;for(var n=0;n<t;n++)i+=e.charAt(Math.floor(Math.random()*e.length));return i}}}),define("bower_components/pop/pop",["require","zenjs/events","zenjs/util/number"],function(t){var i=function(){},e=t("zenjs/events"),n=t("zenjs/util/number");return window.zenjs=window.zenjs||{},e.extend({init:function(t){this._window=$(window);var e=n.makeRandomString();$("body").append('<div id="'+e+'"                 style="display:none; height: 100%;                 position: fixed; top: 0; left: 0; right: 0;                background-color: rgba(0, 0, 0, '+(t.transparent||".7")+');z-index:1000;opacity:0;transition: opacity ease 0.2s;"></div>'),this.nBg=$("#"+e),this.nBg.on("click",$.proxy(function(){this.isCanNotHide||this.hide()},this));var o=n.makeRandomString();$("body").append('<div id="'+o+'" class="'+(t.className||"")+'" style="overflow:hidden;visibility: hidden;"></div>'),this.nPopContainer=$("#"+o),this.nPopContainer.hide(),this.nPopContainer.css({opacity:0,position:"absolute","z-index":1e3}),t.contentViewClass&&(this.contentViewClass=t.contentViewClass,this.contentViewOptions=$.extend({el:this.nPopContainer},t.contentViewOptions||{}),this.contentView=new this.contentViewClass($.extend({onHide:$.proxy(this.hide,this)},this.contentViewOptions)),this.contentView.onHide=$.proxy(this.hide,this)),this.animationTime=t.animationTime||300,this.isCanNotHide=t.isCanNotHide,this.doNotRemoveOnHide=t.doNotRemoveOnHide||!1,this.onShow=t.onShow||i,this.onHide=t.onHide||i,this.onFinishHide=t.onFinishHide||i,this.html=t.html},render:function(t){return this.renderOptions=t||{},this.contentViewClass?this.contentView.render(this.renderOptions):this.html&&this.nPopContainer.html(this.html),this},show:function(){return this.nBg.show().css({opacity:"1","transition-property":"none"}),this.nPopContainer.show(),this.trigger("pop:show:before"),setTimeout($.proxy(function(){this.trigger("pop:show:after"),this.nPopContainer.show().css("visibility","visible"),this._doShow&&this._doShow(),this.onShow()},this),200),this},hide:function(t){t=t||{};var i=t.doNotRemove||this.doNotRemoveOnHide||!1;this._doHide&&this._doHide(),this.trigger("pop:hide:before"),setTimeout($.proxy(function(){this.nBg.css({opacity:0,"transition-property":"opacity"}),this.trigger("pop:hide:after"),setTimeout($.proxy(function(){this.nBg.hide(),this.nPopContainer.hide(),i||this.destroy()},this),200)},this),this.animationTime),this.onHide()},destroy:function(){return this.nPopContainer.remove(),this.nBg.remove(),this.contentView&&this.contentView.remove(),this}})}),define("bower_components/pop/pop_forbid_scroll",["require","./pop"],function(t){return window.zenjs=window.zenjs||{},t("./pop").extend({init:function(t){this._super(t),t.doNotForbidScroll||(this.on("pop:show:before",$.proxy(this.onBeforePopShow,this)),this.on("pop:show:after",$.proxy(this.onAfterPopShow,this)),this.on("pop:hide:after",$.proxy(this.onAfterPopHide,this)))},onBeforePopShow:function(){this.top=this._window.scrollTop()},onAfterPopShow:function(){this._window.scrollTop(0),this.startShow()},onAfterPopHide:function(){var t,i=function(e){if(t!==this._window.scrollTop()&&e>0)return this._window.scrollTop(t),void setTimeout($.proxy(i,this,e-1));setTimeout($.proxy(this.onFinishHide,this),50)};return function(){this.startHide(),t=this.top,this._window.scrollTop(t),$.proxy(i,this)(2),setTimeout($.proxy(function(){window.zenjs.popList.length<1&&$("html").css("position",this.htmlPosition)},this),200)}}(),startShow:function(){var t=window.zenjs.popList;if(t||(t=window.zenjs.popList=[]),0===t.length){var i=$("body"),e=$("html");this.htmlPosition=e.css("position"),e.css("position","relative"),this.bodyCss=(i.prop("style")||{}).cssText,this.htmlCss=(e.prop("style")||{}).cssText,$("body,html").css({overflow:"hidden",height:this._window.height(),"padding-bottom":0,"margin-bottom":0})}t.indexOf(this)<0&&t.push(this)},startHide:function(){var t=window.zenjs.popList,i=t.indexOf(this);i>-1&&t.splice(i,1),t.length<1&&($("html").attr("style",this.htmlCss||""),$("body").attr("style",this.bodyCss||""))}})}),define("bower_components/pop/popup",["require","./pop_forbid_scroll"],function(t){return t("./pop_forbid_scroll").extend({init:function(t){this._super(t),this.onClickBg=t.onClickBg||function(){},this.onBeforePopupShow=t.onBeforePopupShow||function(){},this.onAfterPopupHide=t.onAfterPopupHide||function(){},this.nPopContainer.css($.extend({left:0,right:0,bottom:0,background:"white"},t.containerCss||{})),this.nPopContainer.css("opacity","0"),this.nPopContainer.on("focus","input, textarea",function(t){var i=$(this),e=$(window),n=e.scrollTop(),o=i.offset().top;(o-n<0||o-n>100)&&setTimeout(function(){var t=o-70;e.scrollTop(t)},400)})},_doShow:function(){this.nPopContainer.addClass("popup"),this.contentView&&this.contentView.height?this.height=this.contentView.height():this.contentView||(this.height=this.nPopContainer.height()),this.onBeforePopupShow(),$(".js-close").click($.proxy(function(t){this.hide()},this)),this.nPopContainer.css({height:this.height+"px",transform:"translate3d(0,100%,0)","-webkit-transform":"translate3d(0,100%,0)"}),this.bodyPadding=$("body").css("padding"),$("body").css("padding","0px"),setTimeout($.proxy(function(){this.nPopContainer.css({transform:"translate3d(0,0,0)","-webkit-transform":"translate3d(0,0,0)","-webkit-transition":"all ease "+this.animationTime+"ms",transition:"all ease "+this.animationTime+"ms",opacity:1})},this)),setTimeout($.proxy(function(){this.contentView&&this.contentView.onAfterPopupShow&&this.contentView.onAfterPopupShow()},this),this.animationTime)},_doHide:function(t){this.nPopContainer.css({transform:"translate3d(0,100%,0)","-webkit-transform":"translate3d(0,100%,0)",opacity:0}),setTimeout($.proxy(function(){$("body").css("padding",this.bodyPadding),this.onAfterPopupHide()},this),this.animationTime)}})}),require(["bower_components/ZanUtil/src/args","bower_components/pop/popup"],function(t,i){new(Backbone.View.extend({events:{"click .gc-checkbox":"handleLock","click .gc-button-link.gc-button-give":"handleSubmit","click .gc-button-link.give_preview":"openPreview","keyup .cell-textarea":"logErr","keyup .cell-input":"logErrInput"},initialize:function(){this.lock=$(".gc-checkbox"),this.signOn=!1,this.isLog=!0,this.isInputLog=!0},logErr:function(){$(".cell-textarea").val().length>50?(this.isLog=!1,$(".cell-textarea").parents(".gc-cell-group").addClass("err")):(this.isLog=!0,$(".cell-textarea").parents(".gc-cell-group").removeClass("err"))},logErrInput:function(){$(".cell-input").val().length>15?(this.isInputLog=!1,$(".cell-input").parents(".gc-cell-group").addClass("err")):(this.isInputLog=!0,$(".cell-input").parents(".gc-cell-group").removeClass("err"))},openPreview:function(){if(!this.isLog)return void motify.log("编辑赠言，最多不超过50个字");if(!this.isInputLog)return void motify.log("署名最多不超过15个字");this.scrollTo();var t=$("#card-data").data("fans-info"),i=$(".cell-textarea").val(),e=$(".cell-input").val();$(".cell-input-checked").val();if($(".gc-card-timeline").hide(),$(".gc-wish-card-container").show(),$(".gc-wish-content-word").text(i),$(".gc-wish-time").text(this.getTime()),!this.signOn)return void $(".gc-wish-person").hide();this.signOn&&0!=e.replace(/(^\s*)|(\s*$)/g,"").length?($(".gc-wish-person").show(),$(".gc-wish-nickname").text(e)):($(".gc-wish-person").show(),$(".gc-wish-nickname").text(t))},scrollTo:function(t){var i={toT:0,durTime:100,delay:30,callback:null},e=$.extend(i,t),n=null,o=$(window),s=o.scrollTop(),r=e.toT-s,a=0,c=Math.round(e.durTime/e.delay),h=function(t){a++;var i=Math.round(r/c);if(a>=c)return o.scrollTop(t),window.clearInterval(n),void(e.callback&&"function"==typeof e.callback&&e.callback());o.scrollTop(s+a*i)};return n=window.setInterval(function(){h(e.toT)},e.delay),o},getTime:function(){var t=new Date;return t.month=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,t.year=t.getDate()<10?"0"+t.getDate():t.getDate(),t.getFullYear()+"."+t.month+"."+t.year},handleLock:function(t){this.lock.hasClass("zent-checked")?this.lock.removeClass("zent-checked"):this.lock.addClass("zent-checked"),this.signOn=!this.signOn},handleSubmit:function(){if(!this.isLog)return void motify.log("编辑赠言，最多不超过50个字");if(!this.isInputLog)return void motify.log("署名最多不超过15个字");var t=$("#card-data").data("gift-card-alias"),i=$("#card-data").data("card-no"),e=$("#card-data").data("template-alias"),n=$(".cell-textarea").val(),o=$(".cell-input").val(),s=($(".cell-input-checked").val(),$("#card-data").data("fans-info")),r={};if(this.signOn){if(0!=o.replace(/(^\s*)|(\s*$)/g,"").length)r={gift_card_alias:t,gift_card_no:i,template_alias:e,words:n,sign:o};else if(r={gift_card_alias:t,gift_card_no:i,template_alias:e,words:n,sign:s},s.length>15)return $(".cell-input").parents(".gc-cell-group").addClass("err"),void motify.log("署名超过15个字啦～")}else r={gift_card_alias:t,gift_card_no:i,template_alias:e,words:n};0!=n.replace(/(^\s*)|(\s*$)/g,"").length?$.ajax({url:"/v2/card/giftcard/give.json",type:"POST",dataType:"json",data:r,beforeSend:function(){},success:function(i){0===i.code?i.data.give_record_id?window.location.href=_global.url.wap+"/card/giftcard/take/?give_record_id="+i.data.give_record_id+"&gift_card_alias="+t:motify.log("赠送失败，请稍后重试"):motify.log(i.msg)},error:function(t,i,e){motify.log("赠送失败，请稍后重试")},complete:function(t,i){}}):motify.log("请输入赠言")}}))({el:$("body")})}),define("main",function(){});